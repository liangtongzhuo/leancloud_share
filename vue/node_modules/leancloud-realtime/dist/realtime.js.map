{"version":3,"file":"realtime.js","sources":["../proto/message-compiled.js","../proto/message.js","../src/utils/global.js","../src/utils/expirable.js","../src/utils/cache.js","../src/utils/index.js","../src/websocket-plus.js","../src/error.js","../src/connection.js","../src/plugin.js","../src/realtime.js","../src/events/im.js","../src/messages/message.js","../src/messages/helpers.js","../src/messages/typed-message.js","../src/messages/recalled-message.js","../src/conversations/conversation-base.js","../src/conversation-member-info.js","../src/signature-factory-runner.js","../src/conversations/persistent-conversation.js","../src/conversations/conversation.js","../src/conversations/chat-room.js","../src/conversations/service-conversation.js","../src/conversations/temporary-conversation.js","../src/conversation-query.js","../src/session-manager.js","../src/im-client.js","../src/events/core.js","../src/messages/binary-message.js","../src/messages/text-message.js","../src/message-parser.js","../src/plugin-im.js","../src/index.js"],"sourcesContent":["module.exports = require(\"protobufjs/dist/protobuf-light\").newBuilder({})['import']({\n    \"package\": \"push_server.messages2\",\n    \"syntax\": \"proto2\",\n    \"options\": {\n        \"objc_class_prefix\": \"AVIM\"\n    },\n    \"messages\": [\n        {\n            \"name\": \"JsonObjectMessage\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"string\",\n                    \"name\": \"data\",\n                    \"id\": 1\n                }\n            ]\n        },\n        {\n            \"name\": \"UnreadTuple\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"int32\",\n                    \"name\": \"unread\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"mid\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"timestamp\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"from\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"data\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"patchTimestamp\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"mentioned\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bytes\",\n                    \"name\": \"binaryMsg\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"convType\",\n                    \"id\": 10\n                }\n            ]\n        },\n        {\n            \"name\": \"LogItem\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"from\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"data\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"timestamp\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"msgId\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"ackAt\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"readAt\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"patchTimestamp\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"mentionAll\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"mentionPids\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"bin\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"convType\",\n                    \"id\": 11\n                }\n            ]\n        },\n        {\n            \"name\": \"ConvMemberInfo\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"pid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"role\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"infoId\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"DataCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"ids\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"JsonObjectMessage\",\n                    \"name\": \"msg\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"offline\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"SessionCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"n\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"s\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"ua\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"r\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"tag\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"deviceId\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"sessionPeerIds\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"onlineSessionPeerIds\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"st\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"stTtl\",\n                    \"id\": 11\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"code\",\n                    \"id\": 12\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"reason\",\n                    \"id\": 13\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"deviceToken\",\n                    \"id\": 14\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"sp\",\n                    \"id\": 15\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"detail\",\n                    \"id\": 16\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"lastUnreadNotifTime\",\n                    \"id\": 17\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"lastPatchTime\",\n                    \"id\": 18\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"configBitmap\",\n                    \"id\": 19\n                }\n            ]\n        },\n        {\n            \"name\": \"ErrorCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"int32\",\n                    \"name\": \"code\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"string\",\n                    \"name\": \"reason\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"appCode\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"detail\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"pids\",\n                    \"id\": 5\n                }\n            ]\n        },\n        {\n            \"name\": \"DirectCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"msg\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"uid\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"fromPeerId\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"timestamp\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"offline\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"hasMore\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"toPeerIds\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"r\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 11\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"id\",\n                    \"id\": 12\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"transient\",\n                    \"id\": 13\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"dt\",\n                    \"id\": 14\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"roomId\",\n                    \"id\": 15\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"pushData\",\n                    \"id\": 16\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"will\",\n                    \"id\": 17\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"patchTimestamp\",\n                    \"id\": 18\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bytes\",\n                    \"name\": \"binaryMsg\",\n                    \"id\": 19\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"mentionPids\",\n                    \"id\": 20\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"mentionAll\",\n                    \"id\": 21\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"convType\",\n                    \"id\": 22\n                }\n            ]\n        },\n        {\n            \"name\": \"AckCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"code\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"reason\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"mid\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"uid\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"fromts\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"tots\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"type\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"ids\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"appCode\",\n                    \"id\": 11\n                }\n            ]\n        },\n        {\n            \"name\": \"UnreadCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"UnreadTuple\",\n                    \"name\": \"convs\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"notifTime\",\n                    \"id\": 2\n                }\n            ]\n        },\n        {\n            \"name\": \"ConvCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"m\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"transient\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"unique\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cdate\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"initBy\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"sort\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"limit\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"skip\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"flag\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"count\",\n                    \"id\": 11\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"udate\",\n                    \"id\": 12\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 13\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"n\",\n                    \"id\": 14\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"s\",\n                    \"id\": 15\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"statusSub\",\n                    \"id\": 16\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"statusPub\",\n                    \"id\": 17\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"statusTTL\",\n                    \"id\": 18\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"uniqueId\",\n                    \"id\": 19\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"targetClientId\",\n                    \"id\": 20\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"maxReadTimestamp\",\n                    \"id\": 21\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"maxAckTimestamp\",\n                    \"id\": 22\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"queryAllMembers\",\n                    \"id\": 23\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"MaxReadTuple\",\n                    \"name\": \"maxReadTuples\",\n                    \"id\": 24\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"cids\",\n                    \"id\": 25\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"ConvMemberInfo\",\n                    \"name\": \"info\",\n                    \"id\": 26\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"tempConv\",\n                    \"id\": 27\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"tempConvTTL\",\n                    \"id\": 28\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"tempConvIds\",\n                    \"id\": 29\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"allowedPids\",\n                    \"id\": 30\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"ErrorCommand\",\n                    \"name\": \"failedPids\",\n                    \"id\": 31\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"next\",\n                    \"id\": 40\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"JsonObjectMessage\",\n                    \"name\": \"results\",\n                    \"id\": 100\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"JsonObjectMessage\",\n                    \"name\": \"where\",\n                    \"id\": 101\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"JsonObjectMessage\",\n                    \"name\": \"attr\",\n                    \"id\": 103\n                }\n            ]\n        },\n        {\n            \"name\": \"RoomCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"roomId\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"s\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"n\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"transient\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"roomPeerIds\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"byPeerId\",\n                    \"id\": 7\n                }\n            ]\n        },\n        {\n            \"name\": \"LogsCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"l\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"limit\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"tt\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"tmid\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"mid\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"checksum\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"stored\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"QueryDirection\",\n                    \"name\": \"direction\",\n                    \"id\": 10,\n                    \"options\": {\n                        \"default\": \"OLD\"\n                    }\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"tIncluded\",\n                    \"id\": 11\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"ttIncluded\",\n                    \"id\": 12\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"lctype\",\n                    \"id\": 13\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"LogItem\",\n                    \"name\": \"logs\",\n                    \"id\": 105\n                }\n            ],\n            \"enums\": [\n                {\n                    \"name\": \"QueryDirection\",\n                    \"syntax\": \"proto2\",\n                    \"values\": [\n                        {\n                            \"name\": \"OLD\",\n                            \"id\": 1\n                        },\n                        {\n                            \"name\": \"NEW\",\n                            \"id\": 2\n                        }\n                    ]\n                }\n            ]\n        },\n        {\n            \"name\": \"RcpCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"id\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"read\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"from\",\n                    \"id\": 5\n                }\n            ]\n        },\n        {\n            \"name\": \"ReadTuple\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"required\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"timestamp\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"mid\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"MaxReadTuple\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"pid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"maxAckTimestamp\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"maxReadTimestamp\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"ReadCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"cids\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"ReadTuple\",\n                    \"name\": \"convs\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"PresenceCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"StatusType\",\n                    \"name\": \"status\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"sessionPeerIds\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"ReportCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"initiative\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"type\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"data\",\n                    \"id\": 3\n                }\n            ]\n        },\n        {\n            \"name\": \"PatchItem\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"mid\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"timestamp\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"recall\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"data\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"patchTimestamp\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"from\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bytes\",\n                    \"name\": \"binaryMsg\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"bool\",\n                    \"name\": \"mentionAll\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"mentionPids\",\n                    \"id\": 10\n                }\n            ]\n        },\n        {\n            \"name\": \"PatchCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"PatchItem\",\n                    \"name\": \"patches\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"lastPatchTime\",\n                    \"id\": 2\n                }\n            ]\n        },\n        {\n            \"name\": \"PubsubCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"cid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"cids\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"topic\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"subtopic\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"topics\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"subtopics\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"JsonObjectMessage\",\n                    \"name\": \"results\",\n                    \"id\": 7\n                }\n            ]\n        },\n        {\n            \"name\": \"BlacklistCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"srcCid\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"toPids\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"srcPid\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"toCids\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"limit\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"next\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"blockedPids\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"blockedCids\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"string\",\n                    \"name\": \"allowedPids\",\n                    \"id\": 10\n                },\n                {\n                    \"rule\": \"repeated\",\n                    \"type\": \"ErrorCommand\",\n                    \"name\": \"failedPids\",\n                    \"id\": 11\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"t\",\n                    \"id\": 12\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"n\",\n                    \"id\": 13\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"s\",\n                    \"id\": 14\n                }\n            ]\n        },\n        {\n            \"name\": \"GenericCommand\",\n            \"syntax\": \"proto2\",\n            \"fields\": [\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"CommandType\",\n                    \"name\": \"cmd\",\n                    \"id\": 1\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"OpType\",\n                    \"name\": \"op\",\n                    \"id\": 2\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"appId\",\n                    \"id\": 3\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"peerId\",\n                    \"id\": 4\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"i\",\n                    \"id\": 5\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"string\",\n                    \"name\": \"installationId\",\n                    \"id\": 6\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"priority\",\n                    \"id\": 7\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int32\",\n                    \"name\": \"service\",\n                    \"id\": 8\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"int64\",\n                    \"name\": \"serverTs\",\n                    \"id\": 9\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"DataCommand\",\n                    \"name\": \"dataMessage\",\n                    \"id\": 101\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"SessionCommand\",\n                    \"name\": \"sessionMessage\",\n                    \"id\": 102\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"ErrorCommand\",\n                    \"name\": \"errorMessage\",\n                    \"id\": 103\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"DirectCommand\",\n                    \"name\": \"directMessage\",\n                    \"id\": 104\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"AckCommand\",\n                    \"name\": \"ackMessage\",\n                    \"id\": 105\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"UnreadCommand\",\n                    \"name\": \"unreadMessage\",\n                    \"id\": 106\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"ReadCommand\",\n                    \"name\": \"readMessage\",\n                    \"id\": 107\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"RcpCommand\",\n                    \"name\": \"rcpMessage\",\n                    \"id\": 108\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"LogsCommand\",\n                    \"name\": \"logsMessage\",\n                    \"id\": 109\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"ConvCommand\",\n                    \"name\": \"convMessage\",\n                    \"id\": 110\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"RoomCommand\",\n                    \"name\": \"roomMessage\",\n                    \"id\": 111\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"PresenceCommand\",\n                    \"name\": \"presenceMessage\",\n                    \"id\": 112\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"ReportCommand\",\n                    \"name\": \"reportMessage\",\n                    \"id\": 113\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"PatchCommand\",\n                    \"name\": \"patchMessage\",\n                    \"id\": 114\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"PubsubCommand\",\n                    \"name\": \"pubsubMessage\",\n                    \"id\": 115\n                },\n                {\n                    \"rule\": \"optional\",\n                    \"type\": \"BlacklistCommand\",\n                    \"name\": \"blacklistMessage\",\n                    \"id\": 116\n                }\n            ]\n        }\n    ],\n    \"enums\": [\n        {\n            \"name\": \"CommandType\",\n            \"syntax\": \"proto2\",\n            \"values\": [\n                {\n                    \"name\": \"session\",\n                    \"id\": 0\n                },\n                {\n                    \"name\": \"conv\",\n                    \"id\": 1\n                },\n                {\n                    \"name\": \"direct\",\n                    \"id\": 2\n                },\n                {\n                    \"name\": \"ack\",\n                    \"id\": 3\n                },\n                {\n                    \"name\": \"rcp\",\n                    \"id\": 4\n                },\n                {\n                    \"name\": \"unread\",\n                    \"id\": 5\n                },\n                {\n                    \"name\": \"logs\",\n                    \"id\": 6\n                },\n                {\n                    \"name\": \"error\",\n                    \"id\": 7\n                },\n                {\n                    \"name\": \"login\",\n                    \"id\": 8\n                },\n                {\n                    \"name\": \"data\",\n                    \"id\": 9\n                },\n                {\n                    \"name\": \"room\",\n                    \"id\": 10\n                },\n                {\n                    \"name\": \"read\",\n                    \"id\": 11\n                },\n                {\n                    \"name\": \"presence\",\n                    \"id\": 12\n                },\n                {\n                    \"name\": \"report\",\n                    \"id\": 13\n                },\n                {\n                    \"name\": \"echo\",\n                    \"id\": 14\n                },\n                {\n                    \"name\": \"loggedin\",\n                    \"id\": 15\n                },\n                {\n                    \"name\": \"logout\",\n                    \"id\": 16\n                },\n                {\n                    \"name\": \"loggedout\",\n                    \"id\": 17\n                },\n                {\n                    \"name\": \"patch\",\n                    \"id\": 18\n                },\n                {\n                    \"name\": \"pubsub\",\n                    \"id\": 19\n                },\n                {\n                    \"name\": \"blacklist\",\n                    \"id\": 20\n                }\n            ]\n        },\n        {\n            \"name\": \"OpType\",\n            \"syntax\": \"proto2\",\n            \"values\": [\n                {\n                    \"name\": \"open\",\n                    \"id\": 1\n                },\n                {\n                    \"name\": \"add\",\n                    \"id\": 2\n                },\n                {\n                    \"name\": \"remove\",\n                    \"id\": 3\n                },\n                {\n                    \"name\": \"close\",\n                    \"id\": 4\n                },\n                {\n                    \"name\": \"opened\",\n                    \"id\": 5\n                },\n                {\n                    \"name\": \"closed\",\n                    \"id\": 6\n                },\n                {\n                    \"name\": \"query\",\n                    \"id\": 7\n                },\n                {\n                    \"name\": \"query_result\",\n                    \"id\": 8\n                },\n                {\n                    \"name\": \"conflict\",\n                    \"id\": 9\n                },\n                {\n                    \"name\": \"added\",\n                    \"id\": 10\n                },\n                {\n                    \"name\": \"removed\",\n                    \"id\": 11\n                },\n                {\n                    \"name\": \"refresh\",\n                    \"id\": 12\n                },\n                {\n                    \"name\": \"refreshed\",\n                    \"id\": 13\n                },\n                {\n                    \"name\": \"start\",\n                    \"id\": 30\n                },\n                {\n                    \"name\": \"started\",\n                    \"id\": 31\n                },\n                {\n                    \"name\": \"joined\",\n                    \"id\": 32\n                },\n                {\n                    \"name\": \"members_joined\",\n                    \"id\": 33\n                },\n                {\n                    \"name\": \"left\",\n                    \"id\": 39\n                },\n                {\n                    \"name\": \"members_left\",\n                    \"id\": 40\n                },\n                {\n                    \"name\": \"results\",\n                    \"id\": 42\n                },\n                {\n                    \"name\": \"count\",\n                    \"id\": 43\n                },\n                {\n                    \"name\": \"result\",\n                    \"id\": 44\n                },\n                {\n                    \"name\": \"update\",\n                    \"id\": 45\n                },\n                {\n                    \"name\": \"updated\",\n                    \"id\": 46\n                },\n                {\n                    \"name\": \"mute\",\n                    \"id\": 47\n                },\n                {\n                    \"name\": \"unmute\",\n                    \"id\": 48\n                },\n                {\n                    \"name\": \"status\",\n                    \"id\": 49\n                },\n                {\n                    \"name\": \"members\",\n                    \"id\": 50\n                },\n                {\n                    \"name\": \"max_read\",\n                    \"id\": 51\n                },\n                {\n                    \"name\": \"is_member\",\n                    \"id\": 52\n                },\n                {\n                    \"name\": \"member_info_update\",\n                    \"id\": 53\n                },\n                {\n                    \"name\": \"member_info_updated\",\n                    \"id\": 54\n                },\n                {\n                    \"name\": \"member_info_changed\",\n                    \"id\": 55\n                },\n                {\n                    \"name\": \"join\",\n                    \"id\": 80\n                },\n                {\n                    \"name\": \"invite\",\n                    \"id\": 81\n                },\n                {\n                    \"name\": \"leave\",\n                    \"id\": 82\n                },\n                {\n                    \"name\": \"kick\",\n                    \"id\": 83\n                },\n                {\n                    \"name\": \"reject\",\n                    \"id\": 84\n                },\n                {\n                    \"name\": \"invited\",\n                    \"id\": 85\n                },\n                {\n                    \"name\": \"kicked\",\n                    \"id\": 86\n                },\n                {\n                    \"name\": \"upload\",\n                    \"id\": 100\n                },\n                {\n                    \"name\": \"uploaded\",\n                    \"id\": 101\n                },\n                {\n                    \"name\": \"subscribe\",\n                    \"id\": 120\n                },\n                {\n                    \"name\": \"subscribed\",\n                    \"id\": 121\n                },\n                {\n                    \"name\": \"unsubscribe\",\n                    \"id\": 122\n                },\n                {\n                    \"name\": \"unsubscribed\",\n                    \"id\": 123\n                },\n                {\n                    \"name\": \"is_subscribed\",\n                    \"id\": 124\n                },\n                {\n                    \"name\": \"modify\",\n                    \"id\": 150\n                },\n                {\n                    \"name\": \"modified\",\n                    \"id\": 151\n                },\n                {\n                    \"name\": \"block\",\n                    \"id\": 170\n                },\n                {\n                    \"name\": \"unblock\",\n                    \"id\": 171\n                },\n                {\n                    \"name\": \"blocked\",\n                    \"id\": 172\n                },\n                {\n                    \"name\": \"unblocked\",\n                    \"id\": 173\n                },\n                {\n                    \"name\": \"members_blocked\",\n                    \"id\": 174\n                },\n                {\n                    \"name\": \"members_unblocked\",\n                    \"id\": 175\n                },\n                {\n                    \"name\": \"add_shutup\",\n                    \"id\": 180\n                },\n                {\n                    \"name\": \"remove_shutup\",\n                    \"id\": 181\n                },\n                {\n                    \"name\": \"query_shutup\",\n                    \"id\": 182\n                },\n                {\n                    \"name\": \"shutup_added\",\n                    \"id\": 183\n                },\n                {\n                    \"name\": \"shutup_removed\",\n                    \"id\": 184\n                },\n                {\n                    \"name\": \"shutup_result\",\n                    \"id\": 185\n                },\n                {\n                    \"name\": \"shutuped\",\n                    \"id\": 186\n                },\n                {\n                    \"name\": \"unshutuped\",\n                    \"id\": 187\n                },\n                {\n                    \"name\": \"members_shutuped\",\n                    \"id\": 188\n                },\n                {\n                    \"name\": \"members_unshutuped\",\n                    \"id\": 189\n                }\n            ]\n        },\n        {\n            \"name\": \"StatusType\",\n            \"syntax\": \"proto2\",\n            \"values\": [\n                {\n                    \"name\": \"on\",\n                    \"id\": 1\n                },\n                {\n                    \"name\": \"off\",\n                    \"id\": 2\n                }\n            ]\n        }\n    ],\n    \"isNamespace\": true\n}).build();\n","import messages from './message-compiled';\n\nconst {\n  JsonObjectMessage,\n  UnreadTuple,\n  LogItem,\n  DataCommand,\n  SessionCommand,\n  ErrorCommand,\n  DirectCommand,\n  AckCommand,\n  UnreadCommand,\n  ConvCommand,\n  RoomCommand,\n  LogsCommand,\n  RcpCommand,\n  ReadTuple,\n  MaxReadTuple,\n  ReadCommand,\n  PresenceCommand,\n  ReportCommand,\n  GenericCommand,\n  BlacklistCommand,\n  PatchCommand,\n  PatchItem,\n  ConvMemberInfo,\n  CommandType,\n  OpType,\n  StatusType,\n} = messages.push_server.messages2;\n\nexport {\n  JsonObjectMessage,\n  UnreadTuple,\n  LogItem,\n  DataCommand,\n  SessionCommand,\n  ErrorCommand,\n  DirectCommand,\n  AckCommand,\n  UnreadCommand,\n  ConvCommand,\n  RoomCommand,\n  LogsCommand,\n  RcpCommand,\n  ReadTuple,\n  MaxReadTuple,\n  ReadCommand,\n  PresenceCommand,\n  ReportCommand,\n  GenericCommand,\n  BlacklistCommand,\n  PatchCommand,\n  PatchItem,\n  ConvMemberInfo,\n  CommandType,\n  OpType,\n  StatusType,\n};\n","/* eslint-disable */\nexport default (typeof global !== 'undefined'\n  ? global\n  : typeof window !== 'undefined' ? window : {});\n","import d from 'debug';\n\nconst EXPIRED = Symbol('expired');\nconst debug = d('LC:Expirable');\nexport default class Expirable {\n  constructor(value, ttl) {\n    this.originalValue = value;\n    if (typeof ttl === 'number') {\n      this.expiredAt = Date.now() + ttl;\n    }\n  }\n\n  get value() {\n    const expired = this.expiredAt && this.expiredAt <= Date.now();\n    if (expired) debug(`expired: ${this.originalValue}`);\n    return expired ? EXPIRED : this.originalValue;\n  }\n}\nExpirable.EXPIRED = EXPIRED;\n","import d from 'debug';\nimport Expirable from './expirable';\n\nconst debug = d('LC:Cache');\nexport default class Cache {\n  constructor(name = 'anonymous') {\n    this.name = name;\n    this._map = {};\n  }\n\n  get(key) {\n    const cache = this._map[key];\n    if (cache) {\n      const { value } = cache;\n      if (value !== Expirable.EXPIRED) {\n        debug('[%s] hit: %s %O', this.name, key, value);\n        return value;\n      }\n      delete this._map[key];\n    }\n    debug(`[${this.name}] missed: ${key}`);\n    return null;\n  }\n\n  set(key, value, ttl) {\n    debug('[%s] set: %s %O %d', this.name, key, value, ttl);\n    this._map[key] = new Expirable(value, ttl);\n  }\n}\n","import isPlainObject from 'lodash/isPlainObject';\nimport global from './global';\n\nexport { global };\n\nexport const tryAll = promiseConstructors => {\n  const promise = new Promise(promiseConstructors[0]);\n  if (promiseConstructors.length === 1) {\n    return promise;\n  }\n  return promise.catch(() => tryAll(promiseConstructors.slice(1)));\n};\n\n// eslint-disable-next-line no-sequences\nexport const tap = interceptor => value => (interceptor(value), value);\n\nexport { default as Expirable } from './expirable';\nexport { default as Cache } from './cache';\n\n/**\n *  Date stringnumberProtoBuf Long  LeanCloud  Date \n *  falsy\n * @private\n */\nexport const decodeDate = date => {\n  if (!date) return date;\n  if (typeof date === 'string' || typeof date === 'number') {\n    return new Date(date);\n  }\n  if (date.__type === 'Date' && date.iso) {\n    return new Date(date.iso);\n  }\n  // Long\n  if (typeof date.toNumber === 'function') {\n    return new Date(date.toNumber());\n  }\n  return date;\n};\n/**\n *  Date  Date  undefined\n * @private\n */\nexport const getTime = date =>\n  date && date.getTime ? date.getTime() : undefined;\n\n/**\n *  LeanCloud \n *  Date \n * @private\n */\nexport const decode = value => {\n  if (!value) return value;\n  if (value.__type === 'Date' && value.iso) {\n    return new Date(value.iso);\n  }\n  if (isPlainObject(value)) {\n    return Object.keys(value).reduce(\n      (result, key) => ({\n        ...result,\n        [key]: decode(value[key]),\n      }),\n      {}\n    );\n  }\n  return value;\n};\n/**\n *  LeanCloud \n *  Date \n * @private\n */\nexport const encode = value => {\n  if (value instanceof Date) return { __type: 'Date', iso: value.toJSON() };\n  if (isPlainObject(value)) {\n    return Object.keys(value).reduce(\n      (result, key) => ({\n        ...result,\n        [key]: encode(value[key]),\n      }),\n      {}\n    );\n  }\n  return value;\n};\n\nexport const keyRemap = (keymap, obj) =>\n  Object.keys(obj).reduce((newObj, key) => {\n    const newKey = keymap[key] || key;\n    return Object.assign(newObj, {\n      [newKey]: obj[key],\n    });\n  }, {});\n\nexport const isIE10 =\n  global.navigator &&\n  global.navigator.userAgent &&\n  global.navigator.userAgent.indexOf('MSIE 10.') !== -1;\n\n/* eslint-disable no-proto */\nexport const getStaticProperty = (klass, property) =>\n  klass[property] ||\n  (klass.__proto__ ? getStaticProperty(klass.__proto__, property) : undefined);\n/* eslint-enable no-proto */\n\nexport const union = (a, b) => Array.from(new Set([...a, ...b]));\nexport const difference = (a, b) =>\n  Array.from((bSet => new Set(a.filter(x => !bSet.has(x))))(new Set(b)));\n\nconst map = new WeakMap();\n\n// protected property helper\nexport const internal = object => {\n  if (!map.has(object)) {\n    map.set(object, {});\n  }\n  return map.get(object);\n};\n\nexport const compact = (obj, filter) => {\n  if (!isPlainObject(obj)) return obj;\n  const object = Object.assign({}, obj);\n  // eslint-disable-next-line no-restricted-syntax\n  for (const prop in object) {\n    if ({}.hasOwnProperty.call(object, prop)) {\n      const value = object[prop];\n      if (value === filter) {\n        delete object[prop];\n      } else {\n        object[prop] = compact(value, filter);\n      }\n    }\n  }\n  return object;\n};\n\n// debug utility\nconst removeNull = obj => compact(obj, null);\nexport const trim = message => removeNull(JSON.parse(JSON.stringify(message)));\n\nexport const ensureArray = target => {\n  if (Array.isArray(target)) {\n    return target;\n  }\n  if (target === undefined || target === null) {\n    return [];\n  }\n  return [target];\n};\n\nexport const setValue = (target, key, value) => {\n  // '.' is not allowed in Class keys, escaping is not in concern now.\n  const segs = key.split('.');\n  const lastSeg = segs.pop();\n  let currentTarget = target;\n  segs.forEach(seg => {\n    if (currentTarget[seg] === undefined) currentTarget[seg] = {};\n    currentTarget = currentTarget[seg];\n  });\n  currentTarget[lastSeg] = value;\n  return target;\n};\n\nexport const isWeapp =\n  // eslint-disable-next-line no-undef\n  typeof wx === 'object' && typeof wx.connectSocket === 'function';\n\n// throttle decorator\nexport const throttle = wait => (target, property, descriptor) => {\n  const callback = descriptor.value;\n  // very naive, internal use only\n  if (callback.length) {\n    throw new Error('throttled function should not accept any arguments');\n  }\n  return {\n    ...descriptor,\n    value() {\n      let { throttleMeta } = internal(this);\n      if (!throttleMeta) {\n        throttleMeta = {};\n        internal(this).throttleMeta = throttleMeta;\n      }\n      let { [property]: propertyMeta } = throttleMeta;\n      if (!propertyMeta) {\n        propertyMeta = {};\n        throttleMeta[property] = propertyMeta;\n      }\n      const { previouseTimestamp = 0, timeout } = propertyMeta;\n      const now = Date.now();\n      const remainingTime = wait - (now - previouseTimestamp);\n      if (remainingTime <= 0) {\n        throttleMeta[property].previouseTimestamp = now;\n        callback.apply(this);\n      } else if (!timeout) {\n        propertyMeta.timeout = setTimeout(() => {\n          propertyMeta.previouseTimestamp = Date.now();\n          delete propertyMeta.timeout;\n          callback.apply(this);\n        }, remainingTime);\n      }\n    },\n  };\n};\n","// WebSocket with auto reconnecting feature, backup endpoint and EventEmitter interface.\n\nimport d from 'debug';\nimport EventEmitter from 'eventemitter3';\nimport StateMachine from 'javascript-state-machine';\n\nimport WebSocket from 'ws';\n\nimport { ensureArray, tryAll, global } from './utils';\n\nconst debug = d('LC:WebSocketPlus');\n\nexport const OPEN = 'open';\nexport const DISCONNECT = 'disconnect';\nexport const RECONNECT = 'reconnect';\nexport const RETRY = 'retry';\nexport const SCHEDULE = 'schedule';\nexport const OFFLINE = 'offline';\nexport const ONLINE = 'online';\nexport const ERROR = 'error';\nexport const MESSAGE = 'message';\n\nconst HEARTBEAT_TIME = 180000;\nconst TIMEOUT_TIME = 380000;\n\nconst DEFAULT_RETRY_STRATEGY = attempt => Math.min(1000 * 2 ** attempt, 300000);\n\nconst requireConnected = (target, name, descriptor) =>\n  Object.assign({}, descriptor, {\n    value: function requireConnectedWrapper(...args) {\n      this.checkConnectionAvailability(name);\n      return descriptor.value.call(this, ...args);\n    },\n  });\n\nclass WebSocketPlus extends EventEmitter {\n  constructor(getUrls, protocol) {\n    if (typeof WebSocket === 'undefined') {\n      throw new Error(\n        'WebSocket is undefined. Polyfill is required in this runtime.'\n      );\n    }\n    super();\n    this.init();\n    this._protocol = protocol;\n    Promise.resolve(typeof getUrls === 'function' ? getUrls() : getUrls)\n      .then(ensureArray)\n      .then(urls => {\n        this._urls = urls;\n        return this._open();\n      })\n      .then(() => {\n        this.__postponeTimeoutTimer = this._postponeTimeoutTimer.bind(this);\n        if (global.addEventListener) {\n          this.__pause = () => this.pause();\n          this.__resume = () => this.resume();\n          global.addEventListener('offline', this.__pause);\n          global.addEventListener('online', this.__resume);\n        }\n        this.open();\n      })\n      .catch(this.throw.bind(this));\n  }\n\n  _open() {\n    return this._createWs(this._urls, this._protocol).then(ws => {\n      const [first, ...reset] = this._urls;\n      this._urls = [...reset, first];\n      return ws;\n    });\n  }\n\n  _createWs(urls, protocol) {\n    return tryAll(\n      urls.map(url => (resolve, reject) => {\n        debug(`connect [${url}] ${protocol}`);\n        const ws = protocol ? new WebSocket(url, protocol) : new WebSocket(url);\n        ws.binaryType = this.binaryType || 'arraybuffer';\n        ws.onopen = () => resolve(ws);\n        ws.onclose = error => {\n          if (error instanceof Error) {\n            return reject(error);\n          }\n          // in browser, error event is useless\n          return reject(new Error(`Failed to connect [${url}]`));\n        };\n        ws.onerror = ws.onclose;\n      })\n    ).then(ws => {\n      this._ws = ws;\n      this._ws.onclose = this._handleClose.bind(this);\n      this._ws.onmessage = this._handleMessage.bind(this);\n      return ws;\n    });\n  }\n  _destroyWs() {\n    const ws = this._ws;\n    if (!ws) return;\n    ws.onopen = null;\n    ws.onclose = null;\n    ws.onerror = null;\n    ws.onmessage = null;\n    this._ws = null;\n    ws.close();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  onbeforeevent(event, from, to, ...payload) {\n    debug(`${event}: ${from} -> ${to}`, ...payload);\n  }\n  onopen() {\n    this.emit(OPEN);\n  }\n  onconnected() {\n    this._startConnectionKeeper();\n  }\n  onleaveconnected(event, from, to) {\n    this._stopConnectionKeeper();\n    this._destroyWs();\n    if (to === 'offline' || to === 'disconnected') {\n      this.emit(DISCONNECT);\n    }\n  }\n  onpause() {\n    this.emit(OFFLINE);\n  }\n  onbeforeresume() {\n    this.emit(ONLINE);\n  }\n  onreconnect() {\n    this.emit(RECONNECT);\n  }\n  ondisconnected(event, from, to, attempt = 0) {\n    const delay = DEFAULT_RETRY_STRATEGY.call(null, attempt);\n    debug(`schedule attempt=${attempt} delay=${delay}`);\n    this.emit(SCHEDULE, attempt, delay);\n    if (this.__scheduledRetry) {\n      clearTimeout(this.__scheduledRetry);\n    }\n    this.__scheduledRetry = setTimeout(() => {\n      if (this.is('disconnected')) {\n        this.retry(attempt);\n      }\n    }, delay);\n  }\n  onretry(event, from, to, attempt = 0) {\n    this.emit(RETRY, attempt);\n    this._open().then(\n      () => (this.can('reconnect') ? this.reconnect() : this._destroyWs()),\n      () => this.can('fail') && this.fail(attempt + 1)\n    );\n  }\n  onerror(event, from, to, error) {\n    this.emit(ERROR, error);\n  }\n  onclose() {\n    if (global.removeEventListener) {\n      if (this.__pause) global.removeEventListener('offline', this.__pause);\n      if (this.__resume) global.removeEventListener('online', this.__resume);\n    }\n  }\n\n  checkConnectionAvailability(name = 'API') {\n    if (!this.is('connected')) {\n      const currentState = this.current;\n      console.warn(\n        `${name} should not be called when the connection is ${currentState}`\n      );\n      if (this.is('disconnected') || this.is('reconnecting')) {\n        console.warn(\n          'disconnect and reconnect event should be handled to avoid such calls.'\n        );\n      }\n      throw new Error('Connection unavailable');\n    }\n  }\n\n  // jsdoc-ignore-start\n  @requireConnected\n  // jsdoc-ignore-end\n  _ping() {\n    debug('ping');\n    try {\n      this.ping();\n    } catch (error) {\n      console.warn(`websocket ping error: ${error.message}`);\n    }\n  }\n  ping() {\n    if (this._ws.ping) {\n      this._ws.ping();\n    } else {\n      console.warn(`The WebSocket implement does not support sending ping frame.\n        Override ping method to use application defined ping/pong mechanism.`);\n    }\n  }\n\n  _postponeTimeoutTimer() {\n    debug('_postponeTimeoutTimer');\n    this._clearTimeoutTimers();\n    this._timeoutTimer = setTimeout(() => {\n      debug('timeout');\n      this.disconnect();\n    }, TIMEOUT_TIME);\n  }\n  _clearTimeoutTimers() {\n    if (this._timeoutTimer) {\n      clearTimeout(this._timeoutTimer);\n    }\n  }\n  _startConnectionKeeper() {\n    debug('start connection keeper');\n    this._heartbeatTimer = setInterval(this._ping.bind(this), HEARTBEAT_TIME);\n    const addListener = this._ws.addListener || this._ws.addEventListener;\n    addListener.call(this._ws, 'message', this.__postponeTimeoutTimer);\n    addListener.call(this._ws, 'pong', this.__postponeTimeoutTimer);\n    this._postponeTimeoutTimer();\n  }\n  _stopConnectionKeeper() {\n    debug('stop connection keeper');\n    // websockets/ws#489\n    const removeListener =\n      this._ws.removeListener || this._ws.removeEventListener;\n    removeListener.call(this._ws, 'message', this.__postponeTimeoutTimer);\n    removeListener.call(this._ws, 'pong', this.__postponeTimeoutTimer);\n    this._clearTimeoutTimers();\n    if (this._heartbeatTimer) {\n      clearInterval(this._heartbeatTimer);\n    }\n  }\n\n  _handleClose(event) {\n    debug(`ws closed [${event.code}] ${event.reason}`);\n    // socket closed manually, ignore close event.\n    if (this.isFinished()) return;\n    this.handleClose(event);\n  }\n  handleClose() {\n    // reconnect\n    this.disconnect();\n  }\n\n  // jsdoc-ignore-start\n  @requireConnected\n  // jsdoc-ignore-end\n  send(data) {\n    debug('send', data);\n    this._ws.send(data);\n  }\n\n  _handleMessage(event) {\n    debug('message', event.data);\n    this.handleMessage(event.data);\n  }\n  handleMessage(message) {\n    this.emit(MESSAGE, message);\n  }\n}\n\nStateMachine.create({\n  target: WebSocketPlus.prototype,\n  initial: {\n    state: 'initialized',\n    event: 'init',\n    defer: true,\n  },\n  terminal: 'closed',\n  events: [\n    {\n      name: 'open',\n      from: 'initialized',\n      to: 'connected',\n    },\n    {\n      name: 'disconnect',\n      from: 'connected',\n      to: 'disconnected',\n    },\n    {\n      name: 'retry',\n      from: 'disconnected',\n      to: 'reconnecting',\n    },\n    {\n      name: 'fail',\n      from: 'reconnecting',\n      to: 'disconnected',\n    },\n    {\n      name: 'reconnect',\n      from: 'reconnecting',\n      to: 'connected',\n    },\n    {\n      name: 'pause',\n      from: ['connected', 'disconnected', 'reconnecting'],\n      to: 'offline',\n    },\n    {},\n    {\n      name: 'resume',\n      from: 'offline',\n      to: 'disconnected',\n    },\n    {\n      name: 'close',\n      from: ['connected', 'disconnected', 'reconnecting', 'offline'],\n      to: 'closed',\n    },\n    {\n      name: 'throw',\n      from: '*',\n      to: 'error',\n    },\n  ],\n});\n\nexport default WebSocketPlus;\n","export const error = Object.freeze({\n  1000: {\n    name: 'CLOSE_NORMAL',\n  },\n  1006: {\n    name: 'CLOSE_ABNORMAL',\n  },\n  4100: {\n    name: 'APP_NOT_AVAILABLE',\n    message: 'App not exists or realtime message service is disabled.',\n  },\n  4102: {\n    name: 'SIGNATURE_FAILED',\n    message: 'Login signature mismatch.',\n  },\n  4103: {\n    name: 'INVALID_LOGIN',\n    message: 'Malformed clientId.',\n  },\n  4105: {\n    name: 'SESSION_REQUIRED',\n    message: 'Message sent before session opened.',\n  },\n  4107: {\n    name: 'READ_TIMEOUT',\n  },\n  4108: {\n    name: 'LOGIN_TIMEOUT',\n  },\n  4109: {\n    name: 'FRAME_TOO_LONG',\n  },\n  4110: {\n    name: 'INVALID_ORIGIN',\n    message: 'Access denied by domain whitelist.',\n  },\n  4111: {\n    name: 'SESSION_CONFLICT',\n  },\n  4112: {\n    name: 'SESSION_TOKEN_EXPIRED',\n  },\n  4113: {\n    name: 'APP_QUOTA_EXCEEDED',\n    message: 'The daily active users limit exceeded.',\n  },\n  4116: {\n    name: 'MESSAGE_SENT_QUOTA_EXCEEDED',\n    message: 'Command sent too fast.',\n  },\n  4200: {\n    name: 'INTERNAL_ERROR',\n    message: 'Internal error, please contact LeanCloud for support.',\n  },\n  4301: {\n    name: 'CONVERSATION_API_FAILED',\n    message: 'Upstream Conversatoin API failed, see error.detail for details.',\n  },\n  4302: {\n    name: 'CONVERSATION_SIGNATURE_FAILED',\n    message: 'Conversation action signature mismatch.',\n  },\n  4303: {\n    name: 'CONVERSATION_NOT_FOUND',\n  },\n  4304: {\n    name: 'CONVERSATION_FULL',\n  },\n  4305: {\n    name: 'CONVERSATION_REJECTED_BY_APP',\n    message: 'Conversation action rejected by hook.',\n  },\n  4306: {\n    name: 'CONVERSATION_UPDATE_FAILED',\n  },\n  4307: {\n    name: 'CONVERSATION_READ_ONLY',\n  },\n  4308: {\n    name: 'CONVERSATION_NOT_ALLOWED',\n  },\n  4309: {\n    name: 'CONVERSATION_UPDATE_REJECTED',\n    message: 'Conversation update rejected because the client is not a member.',\n  },\n  4310: {\n    name: 'CONVERSATION_QUERY_FAILED',\n    message: 'Conversation query failed because it is too expansive.',\n  },\n  4311: {\n    name: 'CONVERSATION_LOG_FAILED',\n  },\n  4312: {\n    name: 'CONVERSATION_LOG_REJECTED',\n    message:\n      'Message query rejected because the client is not a member of the conversation.',\n  },\n  4313: {\n    name: 'SYSTEM_CONVERSATION_REQUIRED',\n  },\n  4314: {\n    name: 'NORMAL_CONVERSATION_REQUIRED',\n  },\n  4315: {\n    name: 'CONVERSATION_BLACKLISTED',\n    message: 'Blacklisted in the conversation.',\n  },\n  4316: {\n    name: 'TRANSIENT_CONVERSATION_REQUIRED',\n  },\n  4317: {\n    name: 'CONVERSATION_MEMBERSHIP_REQUIRED',\n  },\n  4318: {\n    name: 'CONVERSATION_API_QUOTA_EXCEEDED',\n    message: 'LeanCloud API quota exceeded. You may upgrade your plan.',\n  },\n  4323: {\n    name: 'TEMPORARY_CONVERSATION_EXPIRED',\n    message: 'Temporary conversation expired or does not exist.',\n  },\n  4401: {\n    name: 'INVALID_MESSAGING_TARGET',\n    message: 'Conversation does not exist or client is not a member.',\n  },\n  4402: {\n    name: 'MESSAGE_REJECTED_BY_APP',\n    message: 'Message rejected by hook.',\n  },\n  4403: {\n    name: 'MESSAGE_OWNERSHIP_REQUIRED',\n  },\n  4404: {\n    name: 'MESSAGE_NOT_FOUND',\n  },\n  4405: {\n    name: 'MESSAGE_UPDATE_REJECTED_BY_APP',\n    message: 'Message update rejected by hook.',\n  },\n  4406: {\n    name: 'MESSAGE_EDIT_DISABLED',\n  },\n  4407: {\n    name: 'MESSAGE_RECALL_DISABLED',\n  },\n});\n\nexport const ErrorCode = Object.freeze(\n  Object.keys(error).reduce(\n    (result, code) =>\n      Object.assign(result, {\n        [error[code].name]: Number(code),\n      }),\n    {}\n  )\n);\n\nexport const createError = ({\n  code,\n  reason,\n  appCode,\n  detail,\n  error: errorMessage,\n}) => {\n  let message = reason || detail || errorMessage;\n  let name = reason;\n  if (!message && error[code]) {\n    ({ name } = error[code]);\n    message = error[code].message || name;\n  }\n  if (!message) {\n    message = `Unknow Error: ${code}`;\n  }\n  const err = new Error(message);\n  return Object.assign(err, {\n    code,\n    appCode,\n    detail,\n    name,\n  });\n};\n","import d from 'debug';\nimport WebSocketPlus, {\n  OPEN,\n  DISCONNECT,\n  RECONNECT,\n  RETRY,\n  SCHEDULE,\n  OFFLINE,\n  ONLINE,\n  ERROR,\n  MESSAGE,\n} from './websocket-plus';\nimport { createError } from './error';\nimport { GenericCommand, CommandType } from '../proto/message';\nimport { trim, isWeapp } from './utils';\n\nconst debug = d('LC:Connection');\n\nconst COMMAND_TIMEOUT = 20000;\n\nexport {\n  OPEN,\n  DISCONNECT,\n  RECONNECT,\n  RETRY,\n  SCHEDULE,\n  OFFLINE,\n  ONLINE,\n  ERROR,\n  MESSAGE,\n};\n\nexport default class Connection extends WebSocketPlus {\n  constructor(getUrl, { format, version }) {\n    debug('initializing Connection');\n    const protocolString = `lc.${format}.${version}`;\n    if (!isWeapp) {\n      super(getUrl, protocolString);\n    } else {\n      super(\n        getUrl().then(urls =>\n          urls.map(\n            url =>\n              `${url}${\n                url.indexOf('?') === -1 ? '?' : '&'\n              }subprotocol=${encodeURIComponent(protocolString)}`\n          )\n        )\n      );\n    }\n    this._protocalFormat = format;\n    this._commands = {};\n    this._serialId = 0;\n  }\n\n  async send(command, waitingForRespond = true) {\n    let serialId;\n    if (waitingForRespond) {\n      this._serialId += 1;\n      serialId = this._serialId;\n      command.i = serialId; // eslint-disable-line no-param-reassign\n    }\n    if (debug.enabled) debug(' %O sent', trim(command));\n\n    let message;\n    if (this._protocalFormat === 'proto2base64') {\n      message = command.toBase64();\n    } else if (command.toArrayBuffer) {\n      message = command.toArrayBuffer();\n    }\n    if (!message) {\n      throw new TypeError(`${command} is not a GenericCommand`);\n    }\n\n    super.send(message);\n\n    if (!waitingForRespond) return undefined;\n    return new Promise((resolve, reject) => {\n      this._commands[serialId] = {\n        resolve,\n        reject,\n        timeout: setTimeout(() => {\n          if (this._commands[serialId]) {\n            if (debug.enabled) debug(' %O timeout', trim(command));\n            reject(\n              createError({\n                error: `Command Timeout [cmd:${command.cmd} op:${command.op}]`,\n                name: 'COMMAND_TIMEOUT',\n              })\n            );\n            delete this._commands[serialId];\n          }\n        }, COMMAND_TIMEOUT),\n      };\n    });\n  }\n\n  handleMessage(msg) {\n    let message;\n    try {\n      message = GenericCommand.decode(msg);\n      if (debug.enabled) debug(' %O received', trim(message));\n    } catch (e) {\n      console.warn('Decode message failed', msg);\n    }\n    const serialId = message.i;\n    if (serialId) {\n      if (this._commands[serialId]) {\n        clearTimeout(this._commands[serialId].timeout);\n        if (message.cmd === CommandType.error) {\n          this._commands[serialId].reject(createError(message.errorMessage));\n        } else {\n          this._commands[serialId].resolve(message);\n        }\n        delete this._commands[serialId];\n      } else {\n        console.warn(`Unexpected command received with serialId [${serialId}],\n         which have timed out or never been requested.`);\n      }\n    } else if (message.cmd === CommandType.error) {\n      this.emit(ERROR, createError(message.errorMessage));\n    } else {\n      this.emit(MESSAGE, message);\n    }\n  }\n\n  ping() {\n    return this.send(\n      new GenericCommand({\n        cmd: CommandType.echo,\n      })\n    ).catch(error => debug('ping failed:', error));\n  }\n}\n","/* eslint-disable max-len */\n\n/**\n * \n *\n * <p>\n * SDK \n * <p>\n *  <code>Realtime</code><code>IMClient</code>  <code>Conversation</code> Decorator Decorator \n *  messageClasses \n * <p>\n * \n *  <code>beforeMessageParse</code><code>afterMessageParse</code>  Middleware Middleware  Promise\n * <code>beforeMessageDispatch</code>  boolean  shouldDispatch \n * <p>\n *  hook  Middleware  Middleware\n *\n * @interface Plugin\n * @since 3.1.0\n */\n\n/* eslint-enable max-len */\n\n/**\n * \n *\n * @name Plugin.name\n * @type string\n */\n\n/**\n * \n *\n * @name Plugin.messageClasses\n * @type AVMessage[]\n */\n\n/**\n *  Realtime \n * <p>\n *  Realtime \n *\n * @name Plugin.onRealtimeCreate\n * @type Function\n */\n\n/**\n *  IMClient \n * <p>\n *  IMClient \n *\n * @name Plugin.onIMClientCreate\n * @type Function\n */\n\n/**\n *  Conversation \n * <p>\n *  Conversation \n *  <code>{@link IMClient#createConversation}</code>  hook\n *  Conversation  query  hook\n *\n * @name Plugin.onConversationCreate\n * @type Function\n */\n\n/**\n *  parse \n * <p>\n *  JSON \n *  JSON  Promise(fulfilled with a JSON)\n *\n * @name Plugin.beforeMessageParse\n * @type Function\n */\n\n/**\n *  parse \n * <p>\n *  Message \n *  Promise\n *\n * @name Plugin.afterMessageParse\n * @type Function\n */\n\n/**\n * \n * <p>\n *  message  conversation\n *  boolean  false  SDK  beforeMessageDispatch \n *  Promise\n *\n * @name Plugin.beforeMessageDispatch\n * @type Function\n * @since 3.4.0\n */\n\nimport { ensureArray, tap } from './utils';\n\nconst checkType = middleware => param => {\n  const { constructor } = param;\n  return Promise.resolve(param)\n    .then(middleware)\n    .then(\n      tap(result => {\n        if (result === undefined || result === null) {\n          // eslint-disable-next-line max-len\n          return console.warn(\n            `Middleware[${middleware._pluginName ||\n              'anonymous plugin'}:${middleware.name ||\n              'anonymous middleware'}] param/return types not match. It returns ${result} while a ${\n              param.constructor.name\n            } expected.`\n          );\n        }\n        if (!(result instanceof constructor)) {\n          // eslint-disable-next-line max-len\n          return console.warn(\n            `Middleware[${middleware._pluginName ||\n              'anonymous plugin'}:${middleware.name ||\n              'anonymous middleware'}] param/return types not match. It returns a ${\n              result.constructor.name\n            } while a ${param.constructor.name} expected.`\n          );\n        }\n        return 0;\n      })\n    );\n};\n\nexport const applyDecorators = (decorators, target) => {\n  if (decorators) {\n    decorators.forEach(decorator => {\n      try {\n        decorator(target);\n      } catch (error) {\n        if (decorator._pluginName) {\n          error.message += `[${decorator._pluginName}]`;\n        }\n        throw error;\n      }\n    });\n  }\n};\n\nexport const applyMiddlewares = middlewares => target =>\n  ensureArray(middlewares).reduce(\n    (previousPromise, middleware) =>\n      previousPromise.then(checkType(middleware)).catch(error => {\n        if (middleware._pluginName) {\n          // eslint-disable-next-line no-param-reassign\n          error.message += `[${middleware._pluginName}]`;\n        }\n        throw error;\n      }),\n    Promise.resolve(target)\n  );\n\nexport const applyDispatcher = (dispatchers, payload) =>\n  ensureArray(dispatchers).reduce(\n    (resultPromise, dispatcher) =>\n      resultPromise\n        .then(\n          shouldDispatch =>\n            shouldDispatch === false ? false : dispatcher(...payload)\n        )\n        .catch(error => {\n          if (dispatcher._pluginName) {\n            // eslint-disable-next-line no-param-reassign\n            error.message += `[${dispatcher._pluginName}]`;\n          }\n          throw error;\n        }),\n    Promise.resolve(true)\n  );\n","import d from 'debug';\nimport EventEmitter from 'eventemitter3';\nimport axios from 'axios';\nimport shuffle from 'lodash/shuffle';\nimport Connection, {\n  OPEN,\n  DISCONNECT,\n  RECONNECT,\n  RETRY,\n  SCHEDULE,\n  OFFLINE,\n  ONLINE,\n  ERROR,\n  MESSAGE,\n} from './connection';\nimport { ErrorCode, createError } from './error';\nimport { tap, Cache, trim, internal, ensureArray, isWeapp } from './utils';\nimport { applyDecorators, applyDispatcher } from './plugin';\nimport { version as VERSION } from '../package.json';\n\nconst debug = d('LC:Realtime');\nconst debugRequest = d('LC:request');\n\nconst routerCache = new Cache('push-router');\n\nexport default class Realtime extends EventEmitter {\n  /**\n   * @extends EventEmitter\n   * @param  {Object} options\n   * @param  {String} options.appId\n   * @param  {String} options.appKey since 4.0.0\n   * @param  {String} [options.region='cn']  id\n   * @param  {Boolean} [options.pushOfflineMessages=false] \n   * @param  {Boolean} [options.noBinary=false]  WebSocket \n   *                                             WebSocket \n   * @param  {Boolean} [options.ssl=true]  wss \n   * @param  {String} [options.server] since 4.0.0\n   * @param  {String|String[]} [options.RTMServers]  RTM since 4.0.0\n   * @param  {Plugin[]} [options.plugins] since 3.1.0\n   */\n  constructor({ plugins, ...options }) {\n    debug('initializing Realtime %s %O', VERSION, options);\n    super();\n    if (typeof options.appId !== 'string') {\n      throw new TypeError(`appId [${options.appId}] is not a string`);\n    }\n    if (typeof options.appKey !== 'string') {\n      throw new TypeError(`appKey [${options.appKey}] is not a string`);\n    }\n    this._options = Object.assign(\n      {\n        appId: undefined,\n        appKey: undefined,\n        region: 'cn',\n        pushOfflineMessages: false,\n        noBinary: false,\n        ssl: true,\n        RTMServerName: process.env.RTM_SERVER_NAME, // undocumented on purpose, internal use only\n      },\n      options\n    );\n    this._cache = new Cache('endpoints');\n    const _this = internal(this);\n    _this.clients = new Set();\n    _this.pendingClients = new Set();\n    const mergedPlugins = [\n      ...ensureArray(Realtime.__preRegisteredPlugins),\n      ...ensureArray(plugins),\n    ];\n    debug('Using plugins %o', mergedPlugins.map(plugin => plugin.name));\n    this._plugins = mergedPlugins.reduce((result, plugin) => {\n      // eslint-disable-next-line no-restricted-syntax\n      for (const hook in plugin) {\n        if ({}.hasOwnProperty.call(plugin, hook) && hook !== 'name') {\n          if (plugin.name) {\n            ensureArray(plugin[hook]).forEach(value => {\n              // eslint-disable-next-line no-param-reassign\n              value._pluginName = plugin.name;\n            });\n          }\n          // eslint-disable-next-line no-param-reassign\n          result[hook] = ensureArray(result[hook]).concat(plugin[hook]);\n        }\n      }\n      return result;\n    }, {});\n    // onRealtimeCreate hook\n    applyDecorators(this._plugins.onRealtimeCreate, this);\n  }\n\n  async _request({ method, version = '1.1', path, query, headers, data = {} }) {\n    const { appId, region } = this._options;\n    const { api } = await this.constructor._getServerUrls({ appId, region });\n    const url = `https://${api}/${version}${path}`;\n    const options = {\n      method,\n      params: query,\n      headers: {\n        'X-LC-Id': this._options.appId,\n        'X-LC-Key': this._options.appKey,\n        ...headers,\n      },\n      data,\n    };\n    debugRequest('Req: %O %O', url, options);\n    return axios(url, options).then(\n      response => {\n        debugRequest('Res: %O %O %O', url, response.status, response.data);\n        return response.data;\n      },\n      error => {\n        debugRequest(\n          'Error: %O %O %O',\n          url,\n          error.response.status,\n          error.response.data\n        );\n        if (error.response && error.response.data && error.response.data.code) {\n          throw createError(error.response.data);\n        }\n        throw error;\n      }\n    );\n  }\n\n  _open() {\n    if (this._openPromise) return this._openPromise;\n\n    let format = 'protobuf2';\n    if (this._options.noBinary) {\n      //  binary datafallback to base64 string\n      format = 'proto2base64';\n    }\n    let version = 3;\n    if (this._options.pushOfflineMessages) {\n      // \n      version = 1;\n    }\n    const protocol = {\n      format,\n      version,\n    };\n    this._openPromise = new Promise((resolve, reject) => {\n      debug('No connection established, create a new one.');\n      const connection = new Connection(\n        () => this._getRTMServers(this._options),\n        protocol\n      );\n      connection.on(OPEN, () => resolve(connection));\n      connection.on(ERROR, reject);\n      connection.on(MESSAGE, this._dispatchCommand.bind(this));\n      /**\n       * \n       *  SDK see {@link Realtime#event:OFFLINE}\n       *  UI \n       * @event Realtime#DISCONNECT\n       */\n      /**\n       * \n       * @event Realtime#SCHEDULE\n       * @param {Number} attempt \n       * @param {Number} delay \n       */\n      /**\n       * \n       * @event Realtime#RETRY\n       * @param {Number} attempt \n       */\n      /**\n       * \n       *  {@link Realtime#event:DISCONNECT}  UI \n       * @event Realtime#RECONNECT\n       */\n\n      /**\n       * \n       * @event IMClient#DISCONNECT\n       * @see Realtime#event:DISCONNECT\n       * @since 3.2.0\n       */\n      /**\n       * \n       * @event IMClient#SCHEDULE\n       * @param {Number} attempt \n       * @param {Number} delay \n       * @since 3.2.0\n       */\n      /**\n       * \n       * @event IMClient#RETRY\n       * @param {Number} attempt \n       * @since 3.2.0\n       */\n\n      /**\n       * \n       *  {@link Realtime#pause} \n       * @event Realtime#OFFLINE\n       * @since 3.4.0\n       */\n      /**\n       * \n       *  {@link Realtime#resume} \n       * @event Realtime#ONLINE\n       * @since 3.4.0\n       */\n      /**\n       * \n       *  {@link Realtime#pause} \n       * @event IMClient#OFFLINE\n       * @since 3.4.0\n       */\n      /**\n       * \n       *  {@link Realtime#resume} \n       * @event IMClient#ONLINE\n       * @since 3.4.0\n       */\n\n      // event proxy\n      [DISCONNECT, RECONNECT, RETRY, SCHEDULE, OFFLINE, ONLINE].forEach(event =>\n        connection.on(event, (...payload) => {\n          debug(`${event} event emitted. %O`, payload);\n          this.emit(event, ...payload);\n          if (event !== RECONNECT) {\n            internal(this).clients.forEach(client => {\n              client.emit(event, ...payload);\n            });\n          }\n        })\n      );\n      // override handleClose\n      connection.handleClose = function handleClose(event) {\n        const isFatal = [\n          ErrorCode.APP_NOT_AVAILABLE,\n          ErrorCode.INVALID_LOGIN,\n          ErrorCode.INVALID_ORIGIN,\n        ].some(errorCode => errorCode === event.code);\n        if (isFatal) {\n          // in these cases, SDK should throw.\n          this.throw(createError(event));\n        } else {\n          // reconnect\n          this.disconnect();\n        }\n      };\n      internal(this).connection = connection;\n    });\n\n    return this._openPromise;\n  }\n\n  async _getRTMServers(options) {\n    if (options.RTMServers) return shuffle(ensureArray(options.RTMServers));\n    let info;\n    const cachedEndPoints = this._cache.get('endpoints');\n    if (cachedEndPoints) {\n      info = await cachedEndPoints;\n    } else {\n      info = await this.constructor._fetchRTMServers(options);\n      this._cache.set('endpoints', info, info.ttl * 1000);\n    }\n    debug('endpoint info: %O', info);\n    return [info.server, info.secondary];\n  }\n\n  static async _getServerUrls({ appId, region, server }) {\n    debug('fetch server urls');\n    if (server) {\n      if (typeof server !== 'string') return server;\n      return {\n        RTMRouter: server,\n        api: server,\n      };\n    }\n    switch (region) {\n      case 'cn': {\n        const cachedRouter = routerCache.get(appId);\n        if (cachedRouter) return cachedRouter;\n        return axios\n          .get('https://app-router.leancloud.cn/2/route', {\n            params: {\n              appId,\n            },\n            timeout: 20000,\n          })\n          .then(res => res.data)\n          .then(tap(debug))\n          .then(\n            ({ rtm_router_server: RTMRouter, api_server: api, ttl = 3600 }) => {\n              if (!RTMRouter) {\n                throw new Error('rtm router not exists');\n              }\n              const serverUrls = {\n                RTMRouter,\n                api,\n              };\n              routerCache.set(appId, serverUrls, ttl * 1000);\n              return serverUrls;\n            }\n          )\n          .catch(() => {\n            const id = appId.slice(0, 8).toLowerCase();\n            return {\n              RTMRouter: `${id}.rtm.lncld.net`,\n              api: `${id}.api.lncld.net`,\n            };\n          });\n      }\n      case 'us':\n        return {\n          RTMRouter: 'router-a0-push.leancloud.cn',\n          api: 'us-api.leancloud.cn',\n        };\n      default:\n        throw new Error(`Region [${region}] is not supported.`);\n    }\n  }\n\n  static _fetchRTMServers({ appId, region, ssl, server, RTMServerName }) {\n    debug('fetch endpoint info');\n    return this._getServerUrls({ appId, region, server })\n      .then(tap(debug))\n      .then(({ RTMRouter }) =>\n        axios\n          .get(`https://${RTMRouter}/v1/route`, {\n            params: {\n              appId,\n              secure: ssl,\n              features: isWeapp ? 'wechat' : undefined,\n              server: RTMServerName,\n              _t: Date.now(),\n            },\n            timeout: 20000,\n          })\n          .then(res => res.data)\n          .then(tap(debug))\n      );\n  }\n\n  _close() {\n    if (this._openPromise) {\n      this._openPromise.then(connection => connection.close());\n    }\n    delete this._openPromise;\n  }\n\n  /**\n   * \n   * SDK \n   *  `SCHEDULE` `RETRY` \n   */\n  retry() {\n    const { connection } = internal(this);\n    if (!connection) {\n      throw new Error('no connection established');\n    }\n    if (connection.cannot('retry')) {\n      throw new Error(\n        `retrying not allowed when not disconnected. the connection is now ${\n          connection.current\n        }`\n      );\n    }\n    return connection.retry();\n  }\n  /**\n   *  SDK \n   *  SDK \n   *  SDK \n   *\n   * @since 3.4.0\n   * @see Realtime#event:OFFLINE\n   */\n  pause() {\n    //  connection  close\n    //  retry loose\n    const { connection } = internal(this);\n    if (!connection) return;\n    if (connection.can('pause')) connection.pause();\n  }\n  /**\n   * \n   *  SDK  SDK \n   *\n   * @since 3.4.0\n   * @see Realtime#event:ONLINE\n   */\n  resume() {\n    //  pause  loose\n    const { connection } = internal(this);\n    if (!connection) return;\n    if (connection.can('resume')) connection.resume();\n  }\n\n  _registerPending(value) {\n    internal(this).pendingClients.add(value);\n  }\n\n  _deregisterPending(client) {\n    internal(this).pendingClients.delete(client);\n  }\n\n  _register(client) {\n    internal(this).clients.add(client);\n  }\n\n  _deregister(client) {\n    const _this = internal(this);\n    _this.clients.delete(client);\n    if (_this.clients.size + _this.pendingClients.size === 0) {\n      this._close();\n    }\n  }\n\n  _dispatchCommand(command) {\n    return applyDispatcher(this._plugins.beforeCommandDispatch, [\n      command,\n      this,\n    ]).then(shouldDispatch => {\n      // no plugin handled this command\n      if (shouldDispatch)\n        return debug('[WARN] Unexpected message received: %O', trim(command));\n      return false;\n    });\n  }\n}\n","// IMClient\nexport const INVITED = 'invited';\nexport const KICKED = 'kicked';\nexport const MEMBERS_JOINED = 'membersjoined';\nexport const MEMBERS_LEFT = 'membersleft';\nexport const MEMBER_INFO_UPDATED = 'memberinfoupdated';\nexport const BLOCKED = 'blocked';\nexport const UNBLOCKED = 'unblocked';\nexport const MEMBERS_BLOCKED = 'membersblocked';\nexport const MEMBERS_UNBLOCKED = 'membersunblocked';\nexport const MUTED = 'muted';\nexport const UNMUTED = 'unmuted';\nexport const MEMBERS_MUTED = 'membersmuted';\nexport const MEMBERS_UNMUTED = 'membersunmuted';\nexport const MESSAGE = 'message';\nexport const UNREAD_MESSAGES_COUNT_UPDATE = 'unreadmessagescountupdate';\nexport const CLOSE = 'close';\nexport const CONFLICT = 'conflict';\nexport const UNHANDLED_MESSAGE = 'unhandledmessage';\nexport const CONVERSATION_INFO_UPDATED = 'conversationinfoupdated';\n\n// Conversation\nexport const LAST_DELIVERED_AT_UPDATE = 'lastdeliveredatupdate';\nexport const LAST_READ_AT_UPDATE = 'lastreadatupdate';\nexport const MESSAGE_RECALL = 'messagerecall';\nexport const MESSAGE_UPDATE = 'messageupdate';\nexport const INFO_UPDATED = 'infoupdated';\n","import uuid from 'uuid/v4';\nimport { ensureArray, decodeDate, getTime } from '../utils';\n\n/**\n * \n * @enum {Symbol}\n * @since 3.2.0\n * @memberof module:leancloud-realtime\n */\nconst MessageStatus = {\n  /**  */\n  NONE: Symbol('none'),\n  /**  */\n  SENDING: Symbol('sending'),\n  /**  */\n  SENT: Symbol('sent'),\n  /**  */\n  DELIVERED: Symbol('delivered'),\n  /**  */\n  FAILED: Symbol('failed'),\n};\nObject.freeze(MessageStatus);\n\nconst rMessageStatus = {\n  [MessageStatus.NONE]: true,\n  [MessageStatus.SENDING]: true,\n  [MessageStatus.SENT]: true,\n  [MessageStatus.DELIVERED]: true,\n  [MessageStatus.READ]: true,\n  [MessageStatus.FAILED]: true,\n};\n\nexport { MessageStatus };\nexport default class Message {\n  /**\n   * @implements AVMessage\n   * @param  {Object|String|ArrayBuffer} content \n   */\n  constructor(content) {\n    Object.assign(\n      this,\n      { content },\n      {\n        /**\n         * @type {String}\n         * @memberof Message#\n         */\n        id: uuid(),\n        /**\n         *  conversation id\n         * @memberof Message#\n         * @type {String?}\n         */\n        cid: null,\n        /**\n         * \n         * @memberof Message#\n         * @type {Date}\n         */\n        timestamp: new Date(),\n        /**\n         * \n         * @memberof Message#\n         * @type {String}\n         */\n        from: undefined,\n        /**\n         * \n         * @since 4.0.0\n         * @memberof Message#\n         * @type {String[]}\n         */\n        mentionList: [],\n        /**\n         * \n         * @since 4.0.0\n         * @memberof Message#\n         * @type {Boolean}\n         */\n        mentionedAll: false,\n        _mentioned: false,\n      }\n    );\n    this._setStatus(MessageStatus.NONE);\n  }\n\n  /**\n   *  JSON \n   * @private\n   * @return {Object}\n   */\n  getPayload() {\n    return this.content;\n  }\n\n  _toJSON() {\n    const {\n      id,\n      cid,\n      from,\n      timestamp,\n      deliveredAt,\n      updatedAt,\n      mentionList,\n      mentionedAll,\n      mentioned,\n    } = this;\n    return {\n      id,\n      cid,\n      from,\n      timestamp,\n      deliveredAt,\n      updatedAt,\n      mentionList,\n      mentionedAll,\n      mentioned,\n    };\n  }\n\n  /**\n   *  JSON \n   * @return {Object}  plain Object\n   */\n  toJSON() {\n    return {\n      ...this._toJSON(),\n      data: this.content,\n    };\n  }\n\n  /**\n   *  JSON  toJSON  {@link IMClient#parseMessage} \n   * @return {Object}  plain Object\n   * @since 4.0.0\n   */\n  toFullJSON() {\n    const {\n      content,\n      id,\n      cid,\n      from,\n      timestamp,\n      deliveredAt,\n      _updatedAt,\n      mentionList,\n      mentionedAll,\n    } = this;\n    return {\n      data: content,\n      id,\n      cid,\n      from,\n      timestamp: getTime(timestamp),\n      deliveredAt: getTime(deliveredAt),\n      updatedAt: getTime(_updatedAt),\n      mentionList,\n      mentionedAll,\n    };\n  }\n\n  /**\n   *  {@link module:leancloud-realtime.MessageStatus} \n   * @type {Symbol}\n   * @readonly\n   * @since 3.2.0\n   */\n  get status() {\n    return this._status;\n  }\n\n  _setStatus(status) {\n    if (!rMessageStatus[status]) {\n      throw new Error('Invalid message status');\n    }\n    this._status = status;\n  }\n\n  get timestamp() {\n    return this._timestamp;\n  }\n  set timestamp(value) {\n    this._timestamp = decodeDate(value);\n  }\n\n  /**\n   * \n   * @type {?Date}\n   */\n  get deliveredAt() {\n    return this._deliveredAt;\n  }\n  set deliveredAt(value) {\n    this._deliveredAt = decodeDate(value);\n  }\n\n  /**\n   *  timestamp \n   * @type {Date}\n   * @since 3.5.0\n   */\n  get updatedAt() {\n    return this._updatedAt || this.timestamp;\n  }\n  set updatedAt(value) {\n    this._updatedAt = decodeDate(value);\n  }\n\n  /**\n   * \n   * @type {Boolean}\n   * @readonly\n   * @since 4.0.0\n   */\n  get mentioned() {\n    return this._mentioned;\n  }\n  _updateMentioned(client) {\n    this._mentioned =\n      this.from !== client &&\n      (this.mentionedAll || this.mentionList.indexOf(client) > -1);\n  }\n  /**\n   * \n   * @since 4.0.0\n   * @return {String[]}  id \n   */\n  getMentionList() {\n    return this.mentionList;\n  }\n  /**\n   * \n   * @since 4.0.0\n   * @param {String[]} clients  id \n   * @return {this} self\n   */\n  setMentionList(clients) {\n    this.mentionList = ensureArray(clients);\n    return this;\n  }\n  /**\n   * \n   * @since 4.0.0\n   * @param {Boolean} [value=true]\n   * @return {this} self\n   */\n  mentionAll(value = true) {\n    this.mentionedAll = Boolean(value);\n    return this;\n  }\n\n  /**\n   *  Message\n   *  true\n   * @private\n   * @returns {Boolean}\n   * @implements AVMessage.validate\n   */\n  static validate() {\n    return true;\n  }\n\n  /**\n   * \n   * <pre>\n   *  message message\n   *  json  content  Message\n   * @private\n   * @param  {Object}  json    json \n   * @param  {Message} message  message\n   * @return {Message}\n   * @implements AVMessage.parse\n   */\n  static parse(json, message) {\n    return message || new this(json);\n  }\n}\n","/* eslint-disable no-param-reassign */\nimport { getStaticProperty, isIE10 } from '../utils';\n\n// documented in ../index.js\nexport const messageType = type => {\n  if (typeof type !== 'number') {\n    throw new TypeError(`${type} is not a Number`);\n  }\n  return target => {\n    target.TYPE = type;\n    target.validate = json => json._lctype === type;\n    target.prototype._getType = () => ({ _lctype: type });\n  };\n};\n\n// documented in ../index.js\nexport const messageField = fields => {\n  if (typeof fields !== 'string') {\n    if (!Array.isArray(fields)) {\n      throw new TypeError(`${fields} is not an Array`);\n    } else if (fields.some(value => typeof value !== 'string')) {\n      throw new TypeError('fields contains non-string typed member');\n    }\n  }\n  return target => {\n    // IE10 Hack:\n    // static properties in IE10 will not be inherited from super\n    // search for parse method and assign it manually\n    let originalCustomFields = isIE10\n      ? getStaticProperty(target, '_customFields')\n      : target._customFields;\n    originalCustomFields = Array.isArray(originalCustomFields)\n      ? originalCustomFields\n      : [];\n    target._customFields = originalCustomFields.concat(fields);\n  };\n};\n\n// IE10 Hack:\n// static properties in IE10 will not be inherited from super\n// search for parse method and assign it manually\n\nexport const IE10Compatible = target => {\n  if (isIE10) {\n    target.parse = getStaticProperty(target, 'parse');\n  }\n};\n","import Message from './message';\nimport { messageField } from './helpers';\nimport { getStaticProperty, isIE10, compact } from '../utils';\n\n// jsdoc-ignore-start\n@messageField(['_lctext', '_lcattrs'])\n// jsdoc-ignore-end\n/**\n * \n * @extends Message\n */\nclass TypedMessage extends Message {\n  /**\n   * @type {Number}\n   * @readonly\n   */\n  get type() {\n    return this.constructor.TYPE;\n  }\n\n  /** @type {String} */\n  set text(text) {\n    return this.setText(text);\n  }\n  get text() {\n    return this.getText();\n  }\n\n  /** @type {Object} */\n  set attributes(attributes) {\n    return this.setAttributes(attributes);\n  }\n  get attributes() {\n    return this.getAttributes();\n  }\n\n  /**\n   * \n   *  <code>[] </code>\n   *  text\n   * @type {String}\n   * @readonly\n   */\n  get summary() {\n    return this.text;\n  }\n\n  /**\n   * @param {String} text\n   * @return {this} self\n   */\n  setText(text) {\n    this._lctext = text;\n    return this;\n  }\n  /**\n   * @return {String}\n   */\n  getText() {\n    return this._lctext;\n  }\n\n  /**\n   * @param {Object} attributes\n   * @return {this} self\n   */\n  setAttributes(attributes) {\n    this._lcattrs = attributes;\n    return this;\n  }\n  /**\n   * @return {Object}\n   */\n  getAttributes() {\n    return this._lcattrs;\n  }\n\n  _getCustomFields() {\n    const fields = Array.isArray(this.constructor._customFields)\n      ? this.constructor._customFields\n      : [];\n    return fields.reduce((result, field) => {\n      if (typeof field !== 'string') return result;\n      result[field] = this[field]; // eslint-disable-line no-param-reassign\n      return result;\n    }, {});\n  }\n\n  /* eslint-disable class-methods-use-this */\n  _getType() {\n    throw new Error('not implemented');\n  }\n  /* eslint-enable class-methods-use-this */\n\n  getPayload() {\n    return compact(\n      Object.assign(\n        {\n          _lctext: this.getText(),\n          _lcattrs: this.getAttributes(),\n        },\n        this._getCustomFields(),\n        this._getType()\n      )\n    );\n  }\n\n  toJSON() {\n    const { type, text, attributes, summary } = this;\n    return {\n      ...super._toJSON(),\n      type,\n      text,\n      attributes,\n      summary,\n    };\n  }\n\n  toFullJSON() {\n    return {\n      ...super.toFullJSON(),\n      data: this.getPayload(),\n    };\n  }\n\n  /**\n   * \n   * <pre>\n   *  message  text  attributes  message\n   *  messagenew this()\n   * @protected\n   * @param  {Object}  json    json \n   * @param  {TypedMessage} message  message\n   * @return {TypedMessage}\n   * @implements AVMessage.parse\n   */\n  static parse(json, message = new this()) {\n    message.content = json; // eslint-disable-line no-param-reassign\n    const customFields = isIE10\n      ? getStaticProperty(message.constructor, '_customFields')\n      : message.constructor._customFields;\n    let fields = Array.isArray(customFields) ? customFields : [];\n    fields = fields.reduce((result, field) => {\n      if (typeof field !== 'string') return result;\n      result[field] = json[field]; // eslint-disable-line no-param-reassign\n      return result;\n    }, {});\n    Object.assign(message, fields);\n    return super.parse(json, message);\n  }\n}\n\nexport default TypedMessage;\n","import TypedMessage from './typed-message';\nimport { messageType, IE10Compatible } from './helpers';\n\n// jsdoc-ignore-start\n@messageType(-127)\n@IE10Compatible\n// jsdoc-ignore-end\n/**\n * SDK \n * @extends TypedMessage\n */\nclass RecalledMessage extends TypedMessage {\n  /**\n   *  <code>[]</code>\n   * @type {String}\n   * @readonly\n   */\n  // eslint-disable-next-line class-methods-use-this\n  get summary() {\n    return '[]';\n  }\n}\nexport default RecalledMessage;\n","import EventEmitter from 'eventemitter3';\nimport d from 'debug';\nimport { decodeDate, getTime, internal } from '../utils';\nimport { applyDecorators } from '../plugin';\nimport IMClient from '../im-client';\nimport {\n  GenericCommand,\n  ConvCommand,\n  DirectCommand,\n  LogsCommand,\n  PatchCommand,\n  PatchItem,\n  CommandType,\n  OpType,\n} from '../../proto/message';\nimport * as Event from '../events/im';\nimport { createError } from '../error';\nimport Message, { MessageStatus } from '../messages/message';\nimport RecalledMessage from '../messages/recalled-message';\n\nconst debug = d('LC:Conversation');\n\nconst serializeMessage = message => {\n  const content = message.getPayload();\n  let msg;\n  let binaryMsg;\n  if (content instanceof ArrayBuffer) {\n    binaryMsg = content;\n  } else if (typeof content !== 'string') {\n    msg = JSON.stringify(content);\n  } else {\n    msg = content;\n  }\n  return { msg, binaryMsg };\n};\n\nconst { NEW, OLD } = LogsCommand.QueryDirection;\n\n/**\n * \n * @enum {Number}\n * @since 4.0.0\n * @memberof module:leancloud-realtime\n */\nconst MessageQueryDirection = {\n  /**  */\n  NEW_TO_OLD: OLD,\n  /**  */\n  OLD_TO_NEW: NEW,\n};\nObject.freeze(MessageQueryDirection);\n\nexport { MessageQueryDirection };\n\nexport default class ConversationBase extends EventEmitter {\n  /**\n   * @extends EventEmitter\n   * @private\n   * @abstract\n   */\n  constructor(\n    {\n      id,\n      lastMessageAt,\n      lastMessage,\n      lastDeliveredAt,\n      lastReadAt,\n      unreadMessagesCount = 0,\n      members = [],\n      mentioned = false,\n      ...properties\n    },\n    client\n  ) {\n    super();\n    Object.assign(this, {\n      /**\n       *  id _Conversation  objectId\n       * @memberof ConversationBase#\n       * @type {String}\n       */\n      id,\n      /**\n       * \n       * @memberof ConversationBase#\n       * @type {?Date}\n       */\n      lastMessageAt,\n      /**\n       * \n       * @memberof ConversationBase#\n       * @type {?Message}\n       */\n      lastMessage,\n      /**\n       * \n       * @memberof ConversationBase#\n       * @type {String[]}\n       */\n      members,\n      // other properties provided by subclasses\n      ...properties,\n    });\n    this.members = Array.from(new Set(this.members));\n    Object.assign(internal(this), {\n      messagesWaitingForReceipt: {},\n      lastDeliveredAt,\n      lastReadAt,\n      unreadMessagesCount,\n      mentioned,\n    });\n    if (client instanceof IMClient) {\n      this._client = client;\n    } else {\n      throw new TypeError('Conversation must be initialized with a client');\n    }\n    if (debug.enabled) {\n      Object.values(Event).forEach(event =>\n        this.on(event, (...payload) =>\n          this._debug(`${event} event emitted. %O`, payload)\n        )\n      );\n    }\n    // onConversationCreate hook\n    applyDecorators(this._client._plugins.onConversationCreate, this);\n  }\n\n  /**\n   * \n   * @type {Boolean}\n   * @since 4.0.0\n   */\n  get unreadMessagesMentioned() {\n    return internal(this).unreadMessagesMentioned;\n  }\n  _setUnreadMessagesMentioned(value) {\n    internal(this).unreadMessagesMentioned = Boolean(value);\n  }\n\n  set unreadMessagesCount(value) {\n    if (value !== this.unreadMessagesCount) {\n      internal(this).unreadMessagesCount = value;\n      this._client.emit(Event.UNREAD_MESSAGES_COUNT_UPDATE, [this]);\n    }\n  }\n  /**\n   * \n   * @type {Number}\n   */\n  get unreadMessagesCount() {\n    return internal(this).unreadMessagesCount;\n  }\n\n  set lastMessageAt(value) {\n    const time = decodeDate(value);\n    if (time <= this._lastMessageAt) return;\n    this._lastMessageAt = time;\n  }\n  get lastMessageAt() {\n    return this._lastMessageAt;\n  }\n  /**\n   *  {@link Conversation#fetchReceiptTimestamps} \n   * @type {?Date}\n   * @since 3.4.0\n   */\n  get lastDeliveredAt() {\n    if (this.members.length !== 2) return null;\n    return internal(this).lastDeliveredAt;\n  }\n  _setLastDeliveredAt(value) {\n    const date = decodeDate(value);\n    if (!(date < internal(this).lastDeliveredAt)) {\n      internal(this).lastDeliveredAt = date;\n      /**\n       * \n       * @event ConversationBase#LAST_DELIVERED_AT_UPDATE\n       * @since 3.4.0\n       */\n      this.emit(Event.LAST_DELIVERED_AT_UPDATE);\n    }\n  }\n  /**\n   *  {@link Conversation#fetchReceiptTimestamps} \n   * @type {?Date}\n   * @since 3.4.0\n   */\n  get lastReadAt() {\n    if (this.members.length !== 2) return null;\n    return internal(this).lastReadAt;\n  }\n  _setLastReadAt(value) {\n    const date = decodeDate(value);\n    if (!(date < internal(this).lastReadAt)) {\n      internal(this).lastReadAt = date;\n      /**\n       * \n       * @event ConversationBase#LAST_READ_AT_UPDATE\n       * @since 3.4.0\n       */\n      this.emit(Event.LAST_READ_AT_UPDATE);\n    }\n  }\n\n  /**\n   *  JSON  toJSON  {@link IMClient#parseConversation} \n   * @return {Object}  plain Object\n   * @since 4.0.0\n   */\n  toFullJSON() {\n    const {\n      id,\n      members,\n      lastMessageAt,\n      lastDeliveredAt,\n      lastReadAt,\n      lastMessage,\n      unreadMessagesCount,\n    } = this;\n    return {\n      id,\n      members,\n      lastMessageAt: getTime(lastMessageAt),\n      lastDeliveredAt: getTime(lastDeliveredAt),\n      lastReadAt: getTime(lastReadAt),\n      lastMessage: lastMessage ? lastMessage.toFullJSON() : undefined,\n      unreadMessagesCount,\n    };\n  }\n\n  /**\n   *  JSON \n   * @return {Object}  plain Object\n   * @since 4.0.0\n   */\n  toJSON() {\n    const {\n      id,\n      members,\n      lastMessageAt,\n      lastDeliveredAt,\n      lastReadAt,\n      lastMessage,\n      unreadMessagesCount,\n      unreadMessagesMentioned,\n    } = this;\n    return {\n      id,\n      members,\n      lastMessageAt,\n      lastDeliveredAt,\n      lastReadAt,\n      lastMessage: lastMessage ? lastMessage.toJSON() : undefined,\n      unreadMessagesCount,\n      unreadMessagesMentioned,\n    };\n  }\n\n  _debug(...params) {\n    debug(...params, `[${this.id}]`);\n  }\n\n  _send(command, ...args) {\n    /* eslint-disable no-param-reassign */\n    if (command.cmd === null) {\n      command.cmd = 'conv';\n    }\n    if (command.cmd === 'conv' && command.convMessage === null) {\n      command.convMessage = new ConvCommand();\n    }\n    if (command.convMessage && command.convMessage.cid === null) {\n      command.convMessage.cid = this.id;\n    }\n    /* eslint-enable no-param-reassign */\n    return this._client._send(command, ...args);\n  }\n\n  /**\n   * \n   * @param  {Message} message Message \n   * @param {Object} [options] since v3.3.0\n   * @param {Boolean} [options.transient] since v3.3.1\n   * @param {Boolean} [options.receipt] \n   * @param {Boolean} [options.will] since v3.4.0\n   * \n   * @param {MessagePriority} [options.priority] \n   * see: {@link module:leancloud-realtime.MessagePriority MessagePriority}\n   * @param {Object} [options.pushData] : {@link https://url.leanapp.cn/pushData }\n   * @return {Promise.<Message>} \n   */\n  async send(message, options) {\n    this._debug(message, 'send');\n    if (!(message instanceof Message)) {\n      throw new TypeError(`${message} is not a Message`);\n    }\n    const { transient, receipt, priority, pushData, will } = Object.assign(\n      {},\n      // support Message static property: sendOptions\n      message.constructor.sendOptions,\n      // support Message static property: getSendOptions\n      typeof message.constructor.getSendOptions === 'function'\n        ? message.constructor.getSendOptions(message)\n        : {},\n      options\n    );\n    if (receipt) {\n      if (this.transient) {\n        console.warn(\n          'receipt option is ignored as the conversation is transient.'\n        );\n      } else if (transient) {\n        console.warn(\n          'receipt option is ignored as the message is sent transiently.'\n        );\n      } else if (this.members.length > 2) {\n        console.warn(\n          'receipt option is recommended to be used in one-on-one conversation.'\n        ); // eslint-disable-line max-len\n      }\n    }\n    if (priority && !this.transient) {\n      console.warn(\n        'priority option is ignored as the conversation is not transient.'\n      );\n    }\n    Object.assign(message, {\n      cid: this.id,\n      from: this._client.id,\n    });\n    message._setStatus(MessageStatus.SENDING);\n    const { msg, binaryMsg } = serializeMessage(message);\n    const command = new GenericCommand({\n      cmd: 'direct',\n      directMessage: new DirectCommand({\n        msg,\n        binaryMsg,\n        cid: this.id,\n        r: receipt,\n        transient,\n        dt: message.id,\n        pushData: JSON.stringify(pushData),\n        will,\n        mentionPids: message.mentionList,\n        mentionAll: message.mentionedAll,\n      }),\n      priority,\n    });\n    try {\n      const resCommand = await this._send(command);\n      if (!transient) {\n        const {\n          ackMessage: { uid, t, code, reason, appCode },\n        } = resCommand;\n        if (code !== null) {\n          throw createError({\n            code,\n            reason,\n            appCode,\n          });\n        }\n        Object.assign(message, {\n          id: uid,\n          timestamp: t,\n        });\n        this.lastMessage = message;\n        this.lastMessageAt = message.timestamp;\n      }\n      message._setStatus(MessageStatus.SENT);\n      if (receipt) {\n        internal(this).messagesWaitingForReceipt[message.id] = message;\n      }\n      return message;\n    } catch (error) {\n      message._setStatus(MessageStatus.FAILED);\n      throw error;\n    }\n  }\n\n  async _update(message, newMessage, recall) {\n    this._debug('patch %O %O %O', message, newMessage, recall);\n    if (message instanceof Message) {\n      if (message.from !== this._client.id) {\n        throw new Error('Updating message from others is not allowed');\n      }\n      if (\n        message.status !== MessageStatus.SENT &&\n        message.status !== MessageStatus.DELIVERED\n      ) {\n        throw new Error('Message is not sent');\n      }\n    } else if (!(message.id && message.timestamp)) {\n      throw new TypeError(`${message} is not a Message`);\n    }\n    let msg;\n    let binaryMsg;\n    if (!recall) {\n      const content = serializeMessage(newMessage);\n      ({ msg, binaryMsg } = content);\n    }\n    await this._send(\n      new GenericCommand({\n        cmd: CommandType.patch,\n        op: OpType.modify,\n        patchMessage: new PatchCommand({\n          patches: [\n            new PatchItem({\n              cid: this.id,\n              mid: message.id,\n              timestamp: Number(message.timestamp),\n              recall,\n              data: msg,\n              binaryMsg,\n              mentionPids: newMessage.mentionList,\n              mentionAll: newMessage.mentionedAll,\n            }),\n          ],\n          lastPatchTime: this._client._lastPatchTime,\n        }),\n      })\n    );\n    const { id, cid, timestamp, from, _status } = message;\n    Object.assign(newMessage, {\n      id,\n      cid,\n      timestamp,\n      from,\n      _status,\n    });\n    if (this.lastMessage.id === newMessage.id) {\n      this.lastMessage = newMessage;\n    }\n    return newMessage;\n  }\n\n  /**\n   * \n   * @return {Promise.<Number>}\n   */\n  async count() {\n    this._debug('count');\n    const resCommand = await this._send(\n      new GenericCommand({\n        op: 'count',\n      })\n    );\n    return resCommand.convMessage.count;\n  }\n\n  /**\n   * \n   * @param {AVMessage} message  {id, timestamp} \n   * @param {AVMessage} newMessage \n   * @return {Promise.<AVMessage>} \n   */\n  async update(message, newMessage) {\n    if (!(newMessage instanceof Message)) {\n      throw new TypeError(`${newMessage} is not a Message`);\n    }\n    return this._update(message, newMessage, false);\n  }\n\n  /**\n   * \n   * @param {AVMessage} message  {id, timestamp} \n   * @return {Promise.<RecalledMessage>} \n   */\n  async recall(message) {\n    return this._update(message, new RecalledMessage(), true);\n  }\n\n  /**\n   * \n   *  {@link Conversation#createMessagesIterator}\n   * \n   * startClosed  endClosed \n   *\n   * @param  {Object} [options]\n   * @param  {Number} [options.limit]  20\n   * @param  {Number}   [options.type] \n   * @param  {MessageQueryDirection} [options.direction] \n   *  startTime  endTime\n   *  startTime  endTime\n   * @param  {Date}   [options.startTime] \n   * @param  {String} [options.startMessageId]  startTime \n   * @param  {Boolean}[options.startClosed] \n   * @param  {Date}   [options.endTime] \n   * @param  {String} [options.endMessageId]  endTime \n   * @param  {Boolean}[options.endClosed] \n   *\n   * @param  {Date}   [options.beforeTime] DEPRECATED:  startTime \n   * @param  {String} [options.beforeMessageId] DEPRECATED:  startMessageId \n   *  beforeTime \n   * @param  {Date}   [options.afterTime] DEPRECATED:  endTime \n   * @param  {String} [options.afterMessageId] DEPRECATED:  endMessageId \n   *  afterTime \n   * @return {Promise.<Message[]>} \n   */\n  async queryMessages(options = {}) {\n    this._debug('query messages %O', options);\n    const {\n      beforeTime,\n      beforeMessageId,\n      afterTime,\n      afterMessageId,\n      limit,\n      direction,\n      type,\n      startTime,\n      startMessageId,\n      startClosed,\n      endTime,\n      endMessageId,\n      endClosed,\n    } = options;\n    if (beforeMessageId || beforeTime || afterMessageId || afterTime) {\n      console.warn(\n        'DEPRECATION: queryMessages options beforeTime, beforeMessageId, afterTime and afterMessageId are deprecated in favor of startTime, startMessageId, endTime and endMessageId.'\n      );\n      return this.queryMessages({\n        startTime: beforeTime,\n        startMessageId: beforeMessageId,\n        endTime: afterTime,\n        endMessageId: afterMessageId,\n        limit,\n      });\n    }\n    if (startMessageId && !startTime) {\n      throw new Error(\n        'query option startMessageId must be used with option startTime'\n      );\n    }\n    if (endMessageId && !endTime) {\n      throw new Error(\n        'query option endMessageId must be used with option endTime'\n      );\n    }\n    const conditions = {\n      t: startTime,\n      mid: startMessageId,\n      tIncluded: startClosed,\n      tt: endTime,\n      tmid: endMessageId,\n      ttIncluded: endClosed,\n      l: limit,\n      lctype: type,\n    };\n    if (conditions.t instanceof Date) {\n      conditions.t = conditions.t.getTime();\n    }\n    if (conditions.tt instanceof Date) {\n      conditions.tt = conditions.tt.getTime();\n    }\n    if (direction !== undefined) {\n      conditions.direction = direction;\n    } else if (conditions.tt > conditions.t) {\n      conditions.direction = MessageQueryDirection.OLD_TO_NEW;\n    }\n    const resCommand = await this._send(\n      new GenericCommand({\n        cmd: 'logs',\n        logsMessage: new LogsCommand(\n          Object.assign(conditions, {\n            cid: this.id,\n          })\n        ),\n      })\n    );\n    return Promise.all(\n      resCommand.logsMessage.logs.map(\n        async ({\n          msgId,\n          timestamp,\n          patchTimestamp,\n          from,\n          ackAt,\n          readAt,\n          data,\n          mentionAll,\n          mentionPids,\n          bin,\n        }) => {\n          const messageData = {\n            data,\n            bin,\n            id: msgId,\n            cid: this.id,\n            timestamp,\n            from,\n            deliveredAt: ackAt,\n            updatedAt: patchTimestamp,\n            mentionList: mentionPids,\n            mentionedAll: mentionAll,\n          };\n          const message = await this._client.parseMessage(messageData);\n          let status = MessageStatus.SENT;\n          if (this.members.length === 2) {\n            if (ackAt) status = MessageStatus.DELIVERED;\n            if (ackAt) this._setLastDeliveredAt(ackAt);\n            if (readAt) this._setLastReadAt(readAt);\n          }\n          message._setStatus(status);\n          return message;\n        }\n      )\n    );\n  }\n\n  /**\n   * \n   * @param  {Object} [options]\n   * @param  {Date}   [options.beforeTime] \n   * @param  {String} [options.beforeMessageId]  beforeTime \n   * @param  {Number} [options.limit]  20\n   * @return {AsyncIterater.<Promise.<IteratorResult<Message[]>>>} [AsyncIterator]{@link https://github.com/tc39/proposal-async-iteration} next  Promise\n   * @example\n   * var messageIterator = conversation.createMessagesIterator({ limit: 10 });\n   * messageIterator.next().then(function(result) {\n   *   // result: {\n   *   //   value: [message1, ..., message10],\n   *   //   done: false,\n   *   // }\n   * });\n   * messageIterator.next().then(function(result) {\n   *   // result: {\n   *   //   value: [message11, ..., message20],\n   *   //   done: false,\n   *   // }\n   * });\n   * messageIterator.next().then(function(result) {\n   *   // No more messages\n   *   // result: { value: [], done: true }\n   * });\n   */\n  createMessagesIterator({ beforeTime, beforeMessageId, limit } = {}) {\n    let promise;\n    return {\n      next: () => {\n        if (promise === undefined) {\n          // first call\n          promise = this.queryMessages({\n            limit,\n            startTime: beforeTime,\n            startMessageId: beforeMessageId,\n          });\n        } else {\n          promise = promise.then(prevMessages => {\n            if (prevMessages.length === 0 || prevMessages.length < limit) {\n              // no more messages\n              return [];\n            }\n            return this.queryMessages({\n              startTime: prevMessages[0].timestamp,\n              startMessageId: prevMessages[0].id,\n              limit,\n            });\n          });\n        }\n        return promise.then(value => ({\n          value: Array.from(value),\n          done: value.length === 0 || value.length < limit,\n        }));\n      },\n    };\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async read() {\n    this.unreadMessagesCount = 0;\n    this._setUnreadMessagesMentioned(false);\n    // \n    if (this.transient) return this;\n    const client = this._client;\n    if (!internal(client).readConversationsBuffer) {\n      internal(client).readConversationsBuffer = new Set();\n    }\n    internal(client).readConversationsBuffer.add(this);\n    client._doSendRead();\n    return this;\n  }\n\n  _handleReceipt({ messageId, timestamp, read }) {\n    if (read) {\n      this._setLastReadAt(timestamp);\n    } else {\n      this._setLastDeliveredAt(timestamp);\n    }\n    const { messagesWaitingForReceipt } = internal(this);\n    const message = messagesWaitingForReceipt[messageId];\n    if (!message) return;\n    message._setStatus(MessageStatus.DELIVERED);\n    message.deliveredAt = timestamp;\n    delete messagesWaitingForReceipt[messageId];\n  }\n\n  /**\n   * lastDeliveredAtlastReadAt\n   * @since 3.4.0\n   * @return {Promise.<this>} this\n   */\n  async fetchReceiptTimestamps() {\n    const {\n      convMessage: { maxReadTimestamp, maxAckTimestamp },\n    } = await this._send(\n      new GenericCommand({\n        op: 'max_read',\n      })\n    );\n    this._setLastDeliveredAt(maxAckTimestamp);\n    this._setLastReadAt(maxReadTimestamp);\n    return this;\n  }\n\n  _fetchAllReceiptTimestamps() {\n    const convMessage = new ConvCommand({\n      queryAllMembers: true,\n    });\n    return this._send(\n      new GenericCommand({\n        op: 'max_read',\n        convMessage,\n      })\n    ).then(({ convMessage: { maxReadTuples } }) =>\n      maxReadTuples\n        .filter(\n          maxReadTuple =>\n            maxReadTuple.maxAckTimestamp || maxReadTuple.maxReadTimestamp\n        )\n        .map(({ pid, maxAckTimestamp, maxReadTimestamp }) => ({\n          pid,\n          lastDeliveredAt: decodeDate(maxAckTimestamp),\n          lastReadAt: decodeDate(maxReadTimestamp),\n        }))\n    );\n  }\n}\n","import { internal } from './utils';\n\n/**\n * \n * @enum {String}\n * @since 4.0.0\n * @memberof module:leancloud-realtime\n */\nconst ConversationMemberRole = {\n  /**  */\n  MANAGER: 'Manager',\n  /**  */\n  MEMBER: 'Member',\n};\nObject.freeze(ConversationMemberRole);\nexport { ConversationMemberRole };\n\nexport default class ConversationMemberInfo {\n  /**\n   *  _ConversationMemberInfo \n   * @since 4.0.0\n   */\n  constructor({ conversation, memberId, role }) {\n    if (!conversation) throw new Error('conversation requried');\n    if (!memberId) throw new Error('memberId requried');\n    Object.assign(internal(this), {\n      conversation,\n      memberId,\n      role,\n    });\n  }\n\n  /**\n   *  Id\n   * @type {String}\n   * @readonly\n   */\n  get conversationId() {\n    return internal(this).conversation.id;\n  }\n  /**\n   *  Id\n   * @type {String}\n   * @readonly\n   */\n  get memberId() {\n    return internal(this).memberId;\n  }\n  /**\n   * \n   * @type {module:leancloud-realtime.ConversationMemberRole | String}\n   * @readonly\n   */\n  get role() {\n    return internal(this).role;\n  }\n  /**\n   * \n   * @type {Boolean}\n   * @readonly\n   */\n  get isOwner() {\n    return this.memberId === internal(this).conversation.creator;\n  }\n\n  toJSON() {\n    const { conversationId, memberId, role, isOwner } = this;\n    return {\n      conversationId,\n      memberId,\n      role,\n      isOwner,\n    };\n  }\n}\n","import d from 'debug';\nimport { tap } from './utils';\n\nconst debug = d('LC:SignatureFactoryRunner');\n\nfunction _validateSignature(signatureResult = {}) {\n  const { signature, timestamp, nonce } = signatureResult;\n  if (\n    typeof signature !== 'string' ||\n    typeof timestamp !== 'number' ||\n    typeof nonce !== 'string'\n  ) {\n    throw new Error('malformed signature');\n  }\n  return {\n    signature,\n    timestamp,\n    nonce,\n  };\n}\n\nexport default (signatureFactory, params) =>\n  Promise.resolve()\n    .then(() => {\n      debug('call signatureFactory with %O', params);\n      return signatureFactory(...params);\n    })\n    .then(\n      tap(signatureResult => debug('sign result %O', signatureResult)),\n      error => {\n        // eslint-disable-next-line no-param-reassign\n        error.message = `sign error: ${error.message}`;\n        debug(error);\n        throw error;\n      }\n    )\n    .then(_validateSignature);\n","import isEmpty from 'lodash/isEmpty';\nimport cloneDeep from 'lodash/cloneDeep';\nimport ConversationBase from './conversation-base';\nimport ConversationMemberInfo, {\n  ConversationMemberRole,\n} from '../conversation-member-info';\nimport {\n  decodeDate,\n  getTime,\n  encode,\n  keyRemap,\n  union,\n  difference,\n  internal,\n  setValue,\n  ensureArray,\n} from '../utils';\nimport {\n  GenericCommand,\n  ConvCommand,\n  ConvMemberInfo,\n  JsonObjectMessage,\n  BlacklistCommand,\n  OpType,\n} from '../../proto/message';\nimport runSignatureFactory from '../signature-factory-runner';\nimport { createError } from '../error';\n\n/**\n * \n * @typedef OperationFailureError\n * @type {Error}\n * @property {string} message \n * @property {string[]} clientIds  client id \n * @property {number} [code] \n * @property {string} [detail] \n */\n\n/**\n * \n * @typedef PartiallySuccess\n * @type {Object}\n * @property {string[]} successfulClientIds  client id \n * @property {OperationFailureError[]} failures \n */\n\n/**\n * \n * @typedef PagedResults\n * @type {Object}\n * @property {T[]} results \n * @property {string} [next] \n */\n\nconst createPartiallySuccess = ({ allowedPids, failedPids }) => ({\n  successfulClientIds: allowedPids,\n  failures: failedPids.map(({ pids, ...error }) =>\n    Object.assign(createError(error), { clientIds: pids })\n  ),\n});\n\n/**\n * @extends ConversationBase\n * @private\n * @abstract\n */\nclass PersistentConversation extends ConversationBase {\n  constructor(\n    data,\n    {\n      creator,\n      createdAt,\n      updatedAt,\n      transient = false,\n      system = false,\n      muted = false,\n      mutedMembers = [],\n      ...attributes\n    },\n    client\n  ) {\n    super(\n      {\n        ...data,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {String}\n         */\n        creator,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {Date}\n         */\n        createdAt,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {Date}\n         */\n        updatedAt,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {?String[]}\n         */\n        mutedMembers,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {Boolean}\n         */\n        transient,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {Boolean}\n         * @since 3.3.0\n         */\n        system,\n        /**\n         * \n         * @memberof PersistentConversation#\n         * @type {Boolean}\n         */\n        muted,\n        _attributes: attributes,\n      },\n      client\n    );\n    this._reset();\n  }\n\n  set createdAt(value) {\n    this._createdAt = decodeDate(value);\n  }\n  get createdAt() {\n    return this._createdAt;\n  }\n  set updatedAt(value) {\n    this._updatedAt = decodeDate(value);\n  }\n  get updatedAt() {\n    return this._updatedAt;\n  }\n\n  /**\n   *  _Conversation  name\n   * @type {String}\n   */\n  get name() {\n    return this.get('name');\n  }\n  set name(value) {\n    this.set('name', value);\n  }\n\n  /**\n   * \n   * @since 3.2.0\n   * @param  {String} key key 'x'  Conversation  x \n   * @return {Any} \n   */\n  get(key) {\n    return internal(this).currentAttributes[key];\n  }\n\n  /**\n   * \n   * @since 3.2.0\n   * @param {String} key 'x'  Conversation  x  'x.y.z' \n   * @param {Any} value \n   * @return {this} self\n   * @example\n   *\n   * //  color \n   * conversation.set('color', {\n   *   text: '#000',\n   *   background: '#DDD',\n   * });\n   * //  color.text \n   * conversation.set('color.text', '#333');\n   */\n  set(key, value) {\n    this._debug(`set [${key}]: ${value}`);\n    const { pendingAttributes } = internal(this);\n    const pendingKeys = Object.keys(pendingAttributes);\n    // suppose pendingAttributes = { 'a.b': {} }\n    // set 'a' or 'a.b': delete 'a.b'\n    const re = new RegExp(`^${key}`);\n    const childKeys = pendingKeys.filter(re.test.bind(re));\n    childKeys.forEach(k => {\n      delete pendingAttributes[k];\n    });\n    if (childKeys.length) {\n      pendingAttributes[key] = value;\n    } else {\n      // set 'a.c': nothing to do\n      // set 'a.b.c.d': assign c: { d: {} } to 'a.b'\n      // CAUTION: non-standard API, provided by core-js\n      const parentKey = Array.find(pendingKeys, k => key.indexOf(k) === 0); // 'a.b'\n      if (parentKey) {\n        setValue(\n          pendingAttributes[parentKey],\n          key.slice(parentKey.length + 1),\n          value\n        );\n      } else {\n        pendingAttributes[key] = value;\n      }\n    }\n    this._buildCurrentAttributes();\n    return this;\n  }\n\n  _buildCurrentAttributes() {\n    const { pendingAttributes } = internal(this);\n    internal(this).currentAttributes = Object.keys(pendingAttributes).reduce(\n      (target, k) => setValue(target, k, pendingAttributes[k]),\n      cloneDeep(this._attributes)\n    );\n  }\n\n  _updateServerAttributes(attributes) {\n    Object.keys(attributes).forEach(key =>\n      setValue(this._attributes, key, attributes[key])\n    );\n    this._buildCurrentAttributes();\n  }\n\n  _reset() {\n    internal(this).pendingAttributes = {};\n    internal(this).currentAttributes = this._attributes;\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async save() {\n    this._debug('save');\n    const attr = internal(this).pendingAttributes;\n    if (isEmpty(attr)) {\n      this._debug('nothing touched, resolve with self');\n      return this;\n    }\n    this._debug('attr: %O', attr);\n    const convMessage = new ConvCommand({\n      attr: new JsonObjectMessage({\n        data: JSON.stringify(encode(attr)),\n      }),\n    });\n    const resCommand = await this._send(\n      new GenericCommand({\n        op: 'update',\n        convMessage,\n      })\n    );\n    this.updatedAt = resCommand.convMessage.udate;\n    this._attributes = internal(this).currentAttributes;\n    internal(this).pendingAttributes = {};\n    return this;\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async fetch() {\n    const query = this._client.getQuery().equalTo('objectId', this.id);\n    await query.find();\n    return this;\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async mute() {\n    this._debug('mute');\n    await this._send(\n      new GenericCommand({\n        op: 'mute',\n      })\n    );\n    if (!this.transient) {\n      this.muted = true;\n      this.mutedMembers = union(this.mutedMembers, [this._client.id]);\n    }\n    return this;\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async unmute() {\n    this._debug('unmute');\n    await this._send(\n      new GenericCommand({\n        op: 'unmute',\n      })\n    );\n    if (!this.transient) {\n      this.muted = false;\n      this.mutedMembers = difference(this.mutedMembers, [this._client.id]);\n    }\n    return this;\n  }\n\n  async _appendConversationSignature(command, action, clientIds) {\n    if (this._client.options.conversationSignatureFactory) {\n      const params = [this.id, this._client.id, clientIds.sort(), action];\n      const signatureResult = await runSignatureFactory(\n        this._client.options.conversationSignatureFactory,\n        params\n      );\n      Object.assign(\n        command.convMessage,\n        keyRemap(\n          {\n            signature: 's',\n            timestamp: 't',\n            nonce: 'n',\n          },\n          signatureResult\n        )\n      );\n    }\n  }\n\n  async _appendBlacklistSignature(command, action, clientIds) {\n    if (this._client.options.blacklistSignatureFactory) {\n      const params = [this._client.id, this.id, clientIds.sort(), action];\n      const signatureResult = await runSignatureFactory(\n        this._client.options.blacklistSignatureFactory,\n        params\n      );\n      Object.assign(\n        command.blacklistMessage,\n        keyRemap(\n          {\n            signature: 's',\n            timestamp: 't',\n            nonce: 'n',\n          },\n          signatureResult\n        )\n      );\n    }\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async add(clientIds) {\n    this._debug('add', clientIds);\n    if (typeof clientIds === 'string') {\n      clientIds = [clientIds]; // eslint-disable-line no-param-reassign\n    }\n    const command = new GenericCommand({\n      op: 'add',\n      convMessage: new ConvCommand({\n        m: clientIds,\n      }),\n    });\n    await this._appendConversationSignature(command, 'add', clientIds);\n    const { convMessage, convMessage: { allowedPids } } = await this._send(\n      command\n    );\n    if (!this.transient && !this.system) {\n      this.members = union(this.members, allowedPids);\n    }\n    return createPartiallySuccess(convMessage);\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async remove(clientIds) {\n    this._debug('remove', clientIds);\n    if (typeof clientIds === 'string') {\n      clientIds = [clientIds]; // eslint-disable-line no-param-reassign\n    }\n    const command = new GenericCommand({\n      op: 'remove',\n      convMessage: new ConvCommand({\n        m: clientIds,\n      }),\n    });\n    await this._appendConversationSignature(command, 'remove', clientIds);\n    const { convMessage, convMessage: { allowedPids } } = await this._send(\n      command\n    );\n    if (!this.transient && !this.system) {\n      this.members = difference(this.members, allowedPids);\n    }\n    return createPartiallySuccess(convMessage);\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async join() {\n    this._debug('join');\n    return this.add(this._client.id).then(({ failures }) => {\n      if (failures[0]) throw failures[0];\n      return this;\n    });\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async quit() {\n    this._debug('quit');\n    return this.remove(this._client.id).then(({ failures }) => {\n      if (failures[0]) throw failures[0];\n      return this;\n    });\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async muteMembers(clientIds) {\n    this._debug('mute', clientIds);\n    clientIds = ensureArray(clientIds); // eslint-disable-line no-param-reassign\n    const command = new GenericCommand({\n      op: OpType.add_shutup,\n      convMessage: new ConvCommand({\n        m: clientIds,\n      }),\n    });\n    const { convMessage } = await this._send(command);\n    return createPartiallySuccess(convMessage);\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async unmuteMembers(clientIds) {\n    this._debug('unmute', clientIds);\n    clientIds = ensureArray(clientIds); // eslint-disable-line no-param-reassign\n    const command = new GenericCommand({\n      op: OpType.remove_shutup,\n      convMessage: new ConvCommand({\n        m: clientIds,\n      }),\n    });\n    const { convMessage } = await this._send(command);\n    return createPartiallySuccess(convMessage);\n  }\n\n  /**\n   * \n   * @param {Object} [options]\n   * @param {Number} [options.limit]  10\n   * @param {String} [options.next]  next  limit \n   * @return {PagedResults.<string>}  cureser \n   */\n  async queryMutedMembers({ limit, next } = {}) {\n    this._debug('query muted: limit %O, next: %O', limit, next);\n    const command = new GenericCommand({\n      op: OpType.query_shutup,\n      convMessage: new ConvCommand({\n        limit,\n        next,\n      }),\n    });\n    const { convMessage: { m, next: newNext } } = await this._send(command);\n    return {\n      results: m,\n      next: newNext,\n    };\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async blockMembers(clientIds) {\n    this._debug('block', clientIds);\n    clientIds = ensureArray(clientIds); // eslint-disable-line no-param-reassign\n    const command = new GenericCommand({\n      cmd: 'blacklist',\n      op: OpType.block,\n      blacklistMessage: new BlacklistCommand({\n        srcCid: this.id,\n        toPids: clientIds,\n      }),\n    });\n    await this._appendBlacklistSignature(\n      command,\n      'conversation-block-clients',\n      clientIds\n    );\n    const { blacklistMessage } = await this._send(command);\n    return createPartiallySuccess(blacklistMessage);\n  }\n\n  /**\n   * \n   * @param {String|String[]} clientIds  client id\n   * @return {Promise.<PartiallySuccess>}  id  id \n   */\n  async unblockMembers(clientIds) {\n    this._debug('unblock', clientIds);\n    clientIds = ensureArray(clientIds); // eslint-disable-line no-param-reassign\n    const command = new GenericCommand({\n      cmd: 'blacklist',\n      op: OpType.unblock,\n      blacklistMessage: new BlacklistCommand({\n        srcCid: this.id,\n        toPids: clientIds,\n      }),\n    });\n    await this._appendBlacklistSignature(\n      command,\n      'conversation-unblock-clients',\n      clientIds\n    );\n    const { blacklistMessage } = await this._send(command);\n    return createPartiallySuccess(blacklistMessage);\n  }\n\n  /**\n   * \n   * @param {Object} [options]\n   * @param {Number} [options.limit]  10\n   * @param {String} [options.next]  next  limit \n   * @return {PagedResults.<string>}  cureser \n   */\n  async queryBlockedMembers({ limit, next } = {}) {\n    this._debug('query blocked: limit %O, next: %O', limit, next);\n    const command = new GenericCommand({\n      cmd: 'blacklist',\n      op: OpType.query,\n      blacklistMessage: new BlacklistCommand({\n        srcCid: this.id,\n        limit,\n        next,\n      }),\n    });\n    const {\n      blacklistMessage: { blockedPids, next: newNext },\n    } = await this._send(command);\n    return {\n      results: blockedPids,\n      next: newNext,\n    };\n  }\n\n  /**\n   * \n   * @since 4.0.0\n   * @return {Promise.<ConversationMemberInfo[]>} \n   */\n  async getAllMemberInfo() {\n    const response = await this._client._requestWithSessionToken({\n      method: 'GET',\n      path: '/classes/_ConversationMemberInfo',\n      query: {\n        where: { cid: this.id },\n      },\n    });\n    const memberInfos = response.results.map(\n      info =>\n        new ConversationMemberInfo({\n          conversation: this,\n          memberId: info.clientId,\n          role: info.role,\n        })\n    );\n    const memberInfoMap = {};\n    memberInfos.forEach(memberInfo => {\n      memberInfoMap[memberInfo.memberId] = memberInfo;\n    });\n    this.members.forEach(memberId => {\n      memberInfoMap[memberId] = new ConversationMemberInfo({\n        conversation: this,\n        memberId,\n        role: ConversationMemberRole.MEMBER,\n      });\n    });\n    internal(this).memberInfoMap = memberInfoMap;\n    return this.members.map(memberId => memberInfoMap[memberId]);\n  }\n\n  /**\n   * \n   * @since 4.0.0\n   * @return {Promise.<ConversationMemberInfo>} \n   */\n  async getMemberInfo(memberId) {\n    if (this.members.indexOf(memberId) === -1)\n      throw new Error(\n        `${memberId} is not the mumber of conversation[${this.id}]`\n      );\n    const { memberInfoMap } = internal(this);\n    if (!(memberInfoMap && memberInfoMap[memberId]))\n      await this.getAllMemberInfo();\n    return internal(this).memberInfoMap[memberId];\n  }\n\n  /**\n   * \n   * @since 4.0.0\n   * @param {String} memberId  Id\n   * @param {module:leancloud-realtime.ConversationMemberRole | String} role \n   * @return {Promise.<this>} self\n   */\n  async updateMemberRole(memberId, role) {\n    this._debug('mute');\n    await this._send(\n      new GenericCommand({\n        op: OpType.member_info_update,\n        convMessage: new ConvCommand({\n          targetClientId: memberId,\n          info: new ConvMemberInfo({\n            pid: memberId,\n            role,\n          }),\n        }),\n      })\n    );\n    const { memberInfos } = internal(this);\n    if (memberInfos && memberInfos[memberId]) {\n      internal(memberInfos[memberId]).role = role;\n    }\n    return this;\n  }\n\n  toFullJSON() {\n    const {\n      creator,\n      system,\n      transient,\n      createdAt,\n      updatedAt,\n      _attributes,\n    } = this;\n    return {\n      ...super.toFullJSON(),\n      creator,\n      system,\n      transient,\n      createdAt: getTime(createdAt),\n      updatedAt: getTime(updatedAt),\n      ..._attributes,\n    };\n  }\n\n  toJSON() {\n    const {\n      creator,\n      system,\n      transient,\n      muted,\n      mutedMembers,\n      createdAt,\n      updatedAt,\n      _attributes,\n    } = this;\n    return {\n      ...super.toJSON(),\n      creator,\n      system,\n      transient,\n      muted,\n      mutedMembers,\n      createdAt,\n      updatedAt,\n      ..._attributes,\n    };\n  }\n}\n\nexport default PersistentConversation;\n","import PersistentConversation from './persistent-conversation';\n\n/**\n * \n *\n *  {@link IMClient#createConversation} \n * @extends PersistentConversation\n * @public\n */\nclass Conversation extends PersistentConversation {}\n\nexport default Conversation;\n","import PersistentConversation from './persistent-conversation';\n\n/**\n * \n *\n *  {@link IMClient#createChatRoom} \n * @since 4.0.0\n * @extends PersistentConversation\n * @public\n */\nclass ChatRoom extends PersistentConversation {}\n\nexport default ChatRoom;\n","import PersistentConversation from './persistent-conversation';\n\n/**\n * \n *\n * \n * @since 4.0.0\n * @extends PersistentConversation\n * @public\n */\nclass ServiceConversation extends PersistentConversation {\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async subscribe() {\n    return this.join();\n  }\n\n  /**\n   * \n   * @return {Promise.<this>} self\n   */\n  async unsubscribe() {\n    return this.quit();\n  }\n}\n\nexport default ServiceConversation;\n","import ConversationBase from './conversation-base';\nimport { createError, ErrorCode } from '../error';\nimport { decodeDate, getTime } from '../utils';\n\nconst transformNotFoundError = error =>\n  error.code === ErrorCode.CONVERSATION_NOT_FOUND\n    ? createError({ code: ErrorCode.TEMPORARY_CONVERSATION_EXPIRED })\n    : error;\n\n/**\n * \n * @since 4.0.0\n * @extends ConversationBase\n * @public\n */\nclass TemporaryConversation extends ConversationBase {\n  /**\n   *  {@link IMClient#createTemporaryConversation} \n   */\n  constructor(data, { expiredAt }, client) {\n    super(\n      {\n        ...data,\n        expiredAt,\n      },\n      client\n    );\n  }\n\n  /**\n   * \n   * @type {Date}\n   */\n  set expiredAt(value) {\n    this._expiredAt = decodeDate(value);\n  }\n  get expiredAt() {\n    return this._expiredAt;\n  }\n\n  /**\n   * \n   * @type {Boolean}\n   */\n  get expired() {\n    return this.expiredAt < new Date();\n  }\n\n  async _send(...args) {\n    if (this.expired)\n      throw createError({ code: ErrorCode.TEMPORARY_CONVERSATION_EXPIRED });\n    try {\n      return await super._send(...args);\n    } catch (error) {\n      throw transformNotFoundError(error);\n    }\n  }\n\n  async send(...args) {\n    try {\n      return await super.send(...args);\n    } catch (error) {\n      throw transformNotFoundError(error);\n    }\n  }\n\n  toFullJSON() {\n    const { expiredAt } = this;\n    return {\n      ...super.toFullJSON(),\n      expiredAt: getTime(expiredAt),\n    };\n  }\n\n  toJSON() {\n    const { expiredAt, expired } = this;\n    return {\n      ...super.toJSON(),\n      expiredAt,\n      expired,\n    };\n  }\n}\n\nexport default TemporaryConversation;\n","import d from 'debug';\n\nconst debug = d('LC:ConversationQuery');\n\nexport default class ConversationQuery {\n  static _encode(value) {\n    if (value instanceof Date) {\n      return { __type: 'Date', iso: value.toJSON() };\n    }\n    if (value instanceof RegExp) {\n      return value.source;\n    }\n    return value;\n  }\n\n  static _quote(s) {\n    return `\\\\Q${s.replace('\\\\E', '\\\\E\\\\\\\\E\\\\Q')}\\\\E`;\n  }\n\n  static _calculateFlag(options) {\n    return ['withLastMessagesRefreshed', 'compact'].reduce(\n      // eslint-disable-next-line no-bitwise\n      (prev, key) => (prev << 1) + Boolean(options[key]),\n      0\n    );\n  }\n\n  /**\n   * Create a ConversationQuery\n   * @param  {IMClient} client\n   */\n  constructor(client) {\n    this._client = client;\n    this._where = {};\n    this._extraOptions = {};\n  }\n\n  _addCondition(key, condition, value) {\n    // Check if we already have a condition\n    if (!this._where[key]) {\n      this._where[key] = {};\n    }\n    this._where[key][condition] = this.constructor._encode(value);\n    return this;\n  }\n\n  toJSON() {\n    const json = {\n      where: this._where,\n      flag: this.constructor._calculateFlag(this._extraOptions),\n    };\n    if (typeof this._skip !== 'undefined') json.skip = this._skip;\n    if (typeof this._limit !== 'undefined') json.limit = this._limit;\n    if (typeof this._order !== 'undefined') json.sort = this._order;\n    debug(json);\n    return json;\n  }\n\n  /**\n   * \n   * @param {string[]} peerIds -  ID \n   * @return {ConversationQuery} self\n   */\n  containsMembers(peerIds) {\n    return this.containsAll('m', peerIds);\n  }\n\n  /**\n   * \n   *\n   * @param {string[]} -  ID \n   * @param {Boolean} includeSelf - \n   * @return {ConversationQuery} self\n   */\n  withMembers(peerIds, includeSelf) {\n    const peerIdsSet = new Set(peerIds);\n    if (includeSelf) {\n      peerIdsSet.add(this._client.id);\n    }\n    this.sizeEqualTo('m', peerIdsSet.size);\n    return this.containsMembers(Array.from(peerIdsSet));\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n  equalTo(key, value) {\n    this._where[key] = this.constructor._encode(value);\n    return this;\n  }\n\n  /**\n   *  conversation \n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n  lessThan(key, value) {\n    return this._addCondition(key, '$lt', value);\n  }\n\n  /**\n   *  conversation \n\n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n  lessThanOrEqualTo(key, value) {\n    return this._addCondition(key, '$lte', value);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n\n  greaterThan(key, value) {\n    return this._addCondition(key, '$gt', value);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n\n  greaterThanOrEqualTo(key, value) {\n    return this._addCondition(key, '$gte', value);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param value\n   * @return {ConversationQuery} self\n   */\n  notEqualTo(key, value) {\n    return this._addCondition(key, '$ne', value);\n  }\n\n  /**\n   *  conversation \n   *\n   * @since 3.5.0\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  exists(key) {\n    return this._addCondition(key, '$exists', true);\n  }\n\n  /**\n   *  conversation \n   *\n   * @since 3.5.0\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  doesNotExist(key) {\n    return this._addCondition(key, '$exists', false);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param values\n   * @return {ConversationQuery} self\n   */\n  containedIn(key, values) {\n    return this._addCondition(key, '$in', values);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param values\n   * @return {ConversationQuery} self\n   */\n  notContainsIn(key, values) {\n    return this._addCondition(key, '$nin', values);\n  }\n  /**\n   * conversation\n   *\n   * @param {string} key\n   * @param values\n   * @return {ConversationQuery} self\n   */\n  containsAll(key, values) {\n    return this._addCondition(key, '$all', values);\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param {string} subString\n   * @return {ConversationQuery} self\n   */\n  contains(key, subString) {\n    return this._addCondition(\n      key,\n      '$regex',\n      ConversationQuery._quote(subString)\n    );\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param {string} prefix\n   * @return {ConversationQuery} self\n   */\n  startsWith(key, prefix) {\n    return this._addCondition(\n      key,\n      '$regex',\n      `^${ConversationQuery._quote(prefix)}`\n    );\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param {string} suffix\n   * @return {ConversationQuery} self\n   */\n  endsWith(key, suffix) {\n    return this._addCondition(\n      key,\n      '$regex',\n      `${ConversationQuery._quote(suffix)}$`\n    );\n  }\n\n  /**\n   *  conversation \n   *\n   * @param {string} key\n   * @param {RegExp} regex\n   * @return {ConversationQuery} self\n   */\n  matches(key, regex) {\n    this._addCondition(key, '$regex', regex);\n    // Javascript regex options support mig as inline options but store them\n    // as properties of the object. We support mi & should migrate them to\n    // modifiers\n    let _modifiers = '';\n    if (regex.ignoreCase) {\n      _modifiers += 'i';\n    }\n    if (regex.multiline) {\n      _modifiers += 'm';\n    }\n\n    if (_modifiers && _modifiers.length) {\n      this._addCondition(key, '$options', _modifiers);\n    }\n    return this;\n  }\n\n  /**\n   *  key \n   *\n   * @param {string} key\n   * @param {Number} length\n   * @return {ConversationQuery} self\n   */\n  sizeEqualTo(key, length) {\n    return this._addCondition(key, '$size', length);\n  }\n\n  /**\n   * \n   *\n   * @param {Number} limit - \n   * @return {ConversationQuery} self\n   */\n  limit(limit) {\n    this._limit = limit;\n    return this;\n  }\n\n  /**\n   * \n   *\n   * @param {Number} skip - \n   * @return {ConversationQuery} self\n   */\n  skip(skip) {\n    this._skip = skip;\n    return this;\n  }\n\n  /**\n   * key\n   *\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  ascending(key) {\n    this._order = key;\n    return this;\n  }\n\n  /**\n   * key\n   *\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  addAscending(key) {\n    if (this._order) {\n      this._order += `,${key}`;\n    } else {\n      this._order = key;\n    }\n    return this;\n  }\n\n  /**\n   *  key \n   *\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  descending(key) {\n    this._order = `-${key}`;\n    return this;\n  }\n\n  /**\n   *  key \n   *\n   * @param {string} key\n   * @return {ConversationQuery} self\n   */\n  addDescending(key) {\n    if (this._order) {\n      this._order += `,-${key}`;\n    } else {\n      this._order = `-${key}`;\n    }\n    return this;\n  }\n\n  /**\n   *  conversations \n   * @param  {Boolean} [enabled=true]\n   * @return {ConversationQuery} self\n   */\n  withLastMessagesRefreshed(enabled = true) {\n    this._extraOptions.withLastMessagesRefreshed = enabled;\n    return this;\n  }\n\n  /**\n   *  conversations \n   * @param  {Boolean} [enabled=true]\n   * @return {ConversationQuery} self\n   */\n  compact(enabled = true) {\n    this._extraOptions.compact = enabled;\n    return this;\n  }\n\n  /**\n   * \n   * @return {Promise.<ConversationBase[]>}\n   */\n  async find() {\n    return this._client._executeQuery(this);\n  }\n}\n","import d from 'debug';\nimport { Expirable } from './utils';\n\nconst debug = d('LC:SessionManager');\n\nexport default class SessionManager {\n  constructor({ refresh, onBeforeGetSessionToken } = {}) {\n    this.refresh = refresh;\n    this._onBeforeGetSessionToken = onBeforeGetSessionToken;\n    this.setSessionToken(null, 0);\n  }\n\n  setSessionToken(token, ttl) {\n    debug('set session token', token, ttl);\n    const sessionToken = new Expirable(token, ttl * 1000);\n    this._sessionToken = sessionToken;\n    delete this._pendingSessionTokenPromise;\n    return sessionToken;\n  }\n\n  async setSessionTokenAsync(promise) {\n    const currentSessionToken = this._sessionToken;\n    this._pendingSessionTokenPromise = promise.catch(error => {\n      // revert, otherwise the following getSessionToken calls\n      // will all be rejected\n      this._sessionToken = currentSessionToken;\n      throw error;\n    });\n    return this.setSessionToken(...(await this._pendingSessionTokenPromise));\n  }\n\n  async getSessionToken({ autoRefresh = true } = {}) {\n    debug('get session token');\n    if (this._onBeforeGetSessionToken) {\n      this._onBeforeGetSessionToken(this);\n    }\n    const { value, originalValue } =\n      this._sessionToken || (await this._pendingSessionTokenPromise);\n    if (value === Expirable.EXPIRED && autoRefresh && this.refresh) {\n      debug('refresh expired session token');\n      const { value: newValue } = await this.setSessionTokenAsync(\n        this.refresh(this, originalValue)\n      );\n      debug('session token', newValue);\n      return newValue;\n    }\n    debug('session token', value);\n    return value;\n  }\n\n  revoke() {\n    if (this._sessionToken) this._sessionToken.expiredAt = -1;\n  }\n}\n","import EventEmitter from 'eventemitter3';\nimport { decode as decodeBase64 } from 'base64-arraybuffer';\nimport remove from 'lodash/remove';\nimport d from 'debug';\nimport {\n  Conversation,\n  ChatRoom,\n  ServiceConversation,\n  TemporaryConversation,\n} from './conversations';\nimport ConversationBase from './conversations/conversation-base';\nimport ConversationQuery from './conversation-query';\nimport {\n  GenericCommand,\n  SessionCommand,\n  ConvCommand,\n  AckCommand,\n  JsonObjectMessage,\n  ReadCommand,\n  ReadTuple,\n  CommandType,\n  OpType,\n} from '../proto/message';\nimport * as Event from './events/im';\nimport { ErrorCode, createError } from './error';\nimport {\n  Expirable,\n  Cache,\n  keyRemap,\n  union,\n  difference,\n  trim,\n  internal,\n  throttle,\n  encode,\n  decode,\n  decodeDate,\n  getTime,\n} from './utils';\nimport { applyDecorators, applyDispatcher } from './plugin';\nimport SessionManager from './session-manager';\nimport runSignatureFactory from './signature-factory-runner';\nimport { MessageStatus } from './messages/message';\nimport { version as VERSION } from '../package.json';\n\nconst debug = d('LC:IMClient');\n\nconst {\n  INVITED,\n  KICKED,\n  MEMBERS_JOINED,\n  MEMBERS_LEFT,\n  MEMBER_INFO_UPDATED,\n  BLOCKED,\n  UNBLOCKED,\n  MEMBERS_BLOCKED,\n  MEMBERS_UNBLOCKED,\n  MUTED,\n  UNMUTED,\n  MEMBERS_MUTED,\n  MEMBERS_UNMUTED,\n  MESSAGE,\n  UNREAD_MESSAGES_COUNT_UPDATE,\n  CLOSE,\n  CONFLICT,\n  UNHANDLED_MESSAGE,\n  CONVERSATION_INFO_UPDATED,\n  MESSAGE_RECALL,\n  MESSAGE_UPDATE,\n  INFO_UPDATED,\n} = Event;\n\nconst isTemporaryConversatrionId = id => /^_tmp:/.test(id);\n\n/**\n * 1 patch-msg\n * 1 temp-conv-msg\n * 0 auto-bind-deviceid-and-installation\n * 1 transient-msg-ack\n * 1 keep-notification\n * 1 partial-failed-msg\n * @ignore\n */\nconst configBitmap = 0b111011;\n\nexport default class IMClient extends EventEmitter {\n  /**\n   *  {@link Realtime#createIMClient}  IMClient\n   *\n   * @extends EventEmitter\n   */\n  constructor(id, options = {}, props) {\n    if (!(id === undefined || typeof id === 'string')) {\n      throw new TypeError(`Client id [${id}] is not a String`);\n    }\n    super();\n    Object.assign(\n      this,\n      {\n        /**\n         * @var id {String}  id\n         * @memberof IMClient#\n         */\n        id,\n        options,\n      },\n      props\n    );\n\n    if (!this._messageParser) {\n      throw new Error('IMClient must be initialized with a MessageParser');\n    }\n    this._conversationCache = new Cache(`client:${this.id}`);\n    this._ackMessageBuffer = {};\n    internal(this).lastPatchTime = Date.now();\n    internal(this).lastNotificationTime = undefined;\n    internal(this)._eventemitter = new EventEmitter();\n    if (debug.enabled) {\n      Object.values(Event).forEach(event =>\n        this.on(event, (...payload) =>\n          this._debug(`${event} event emitted. %O`, payload)\n        )\n      );\n    }\n    // onIMClientCreate hook\n    applyDecorators(this._plugins.onIMClientCreate, this);\n  }\n\n  _debug(...params) {\n    debug(...params, `[${this.id}]`);\n  }\n\n  /**\n   * @override\n   * @private\n   */\n  async _dispatchCommand(command) {\n    this._debug(trim(command), 'received');\n    if (command.serverTs) {\n      internal(this).lastNotificationTime = getTime(\n        decodeDate(command.serverTs)\n      );\n    }\n    switch (command.cmd) {\n      case CommandType.conv:\n        return this._dispatchConvMessage(command);\n      case CommandType.direct:\n        return this._dispatchDirectMessage(command);\n      case CommandType.session:\n        return this._dispatchSessionMessage(command);\n      case CommandType.unread:\n        return this._dispatchUnreadMessage(command);\n      case CommandType.rcp:\n        return this._dispatchRcpMessage(command);\n      case CommandType.patch:\n        return this._dispatchPatchMessage(command);\n      default:\n        return this.emit(UNHANDLED_MESSAGE, command);\n    }\n  }\n\n  async _dispatchSessionMessage(message) {\n    const { sessionMessage: { code, reason } } = message;\n    switch (message.op) {\n      case OpType.closed: {\n        internal(this)._eventemitter.emit('close');\n        if (code === ErrorCode.SESSION_CONFLICT) {\n          /**\n           * \n           * @event IMClient#CONFLICT\n           */\n          return this.emit(CONFLICT, {\n            reason,\n          });\n        }\n        /**\n         * \n         * @event IMClient#CLOSE\n         * @param {Object} payload\n         * @param {Number} payload.code \n         * @param {String} payload.reason \n         */\n        return this.emit(CLOSE, {\n          code,\n          reason,\n        });\n      }\n      default:\n        this.emit(UNHANDLED_MESSAGE, message);\n        throw new Error('Unrecognized session command');\n    }\n  }\n\n  _dispatchUnreadMessage({ unreadMessage: { convs, notifTime } }) {\n    internal(this).lastUnreadNotifTime = notifTime;\n    // ensure all converstions are cached\n    return this.getConversations(convs.map(conv => conv.cid))\n      .then(() =>\n        // update conversations data\n        Promise.all(\n          convs.map(\n            ({\n              cid,\n              unread,\n              mid,\n              timestamp: ts,\n              from,\n              data,\n              binaryMsg,\n              patchTimestamp,\n              mentioned,\n            }) => {\n              const conversation = this._conversationCache.get(cid);\n              // deleted conversation\n              if (!conversation) return null;\n              let timestamp;\n              if (ts) {\n                timestamp = decodeDate(ts);\n                conversation.lastMessageAt = timestamp; // eslint-disable-line no-param-reassign\n              }\n              return (mid\n                ? this._messageParser.parse(binaryMsg || data).then(message => {\n                    const messageProps = {\n                      id: mid,\n                      cid,\n                      timestamp,\n                      updatedAt: patchTimestamp,\n                      from,\n                    };\n                    Object.assign(message, messageProps);\n                    conversation.lastMessage = message; // eslint-disable-line no-param-reassign\n                  })\n                : Promise.resolve()\n              ).then(() => {\n                conversation._setUnreadMessagesMentioned(mentioned);\n                const countNotUpdated =\n                  unread === internal(conversation).unreadMessagesCount;\n                if (countNotUpdated) return null; // to be filtered\n                // manipulate internal property directly to skip unreadmessagescountupdate event\n                internal(conversation).unreadMessagesCount = unread;\n                return conversation;\n              });\n              // filter conversations without unread count update\n            }\n          )\n        ).then(conversations =>\n          conversations.filter(conversation => conversation)\n        )\n      )\n      .then(conversations => {\n        if (conversations.length) {\n          /**\n           * \n           * @event IMClient#UNREAD_MESSAGES_COUNT_UPDATE\n           * @since 3.4.0\n           * @param {Conversation[]} conversations \n           */\n          this.emit(UNREAD_MESSAGES_COUNT_UPDATE, conversations);\n        }\n      });\n  }\n\n  async _dispatchRcpMessage(message) {\n    const { rcpMessage, rcpMessage: { read } } = message;\n    const conversationId = rcpMessage.cid;\n    const messageId = rcpMessage.id;\n    const timestamp = decodeDate(rcpMessage.t);\n    const conversation = this._conversationCache.get(conversationId);\n    // conversation not cached means the client does not send the message\n    // during this session\n    if (!conversation) return;\n    conversation._handleReceipt({ messageId, timestamp, read });\n  }\n\n  _dispatchPatchMessage({ patchMessage: { patches } }) {\n    // ensure all converstions are cached\n    return this.getConversations(patches.map(patch => patch.cid)).then(() =>\n      Promise.all(\n        patches.map(\n          ({\n            cid,\n            mid,\n            timestamp,\n            recall,\n            data,\n            patchTimestamp,\n            from,\n            binaryMsg,\n            mentionAll,\n            mentionPids,\n          }) => {\n            const conversation = this._conversationCache.get(cid);\n            // deleted conversation\n            if (!conversation) return null;\n            return this._messageParser\n              .parse(binaryMsg || data)\n              .then(message => {\n                const patchTime = getTime(decodeDate(patchTimestamp));\n                const messageProps = {\n                  id: mid,\n                  cid,\n                  timestamp,\n                  updatedAt: patchTime,\n                  from,\n                  mentionList: mentionPids,\n                  mentionedAll: mentionAll,\n                };\n                Object.assign(message, messageProps);\n                message._setStatus(MessageStatus.SENT);\n                message._updateMentioned(this.id);\n                if (internal(this).lastPatchTime < patchTime) {\n                  internal(this).lastPatchTime = patchTime;\n                }\n                // update conversation lastMessage\n                if (\n                  conversation.lastMessage &&\n                  conversation.lastMessage.id === mid\n                ) {\n                  conversation.lastMessage = message; // eslint-disable-line no-param-reassign\n                }\n                if (recall) {\n                  /**\n                   * \n                   * @event IMClient#MESSAGE_RECALL\n                   * @param {AVMessage} message \n                   * @param {ConversationBase} conversation \n                   */\n                  this.emit(MESSAGE_RECALL, message, conversation);\n                  /**\n                   * \n                   * @event ConversationBase#MESSAGE_RECALL\n                   * @param {AVMessage} message \n                   */\n                  conversation.emit(MESSAGE_RECALL, message);\n                } else {\n                  /**\n                   * \n                   * @event IMClient#MESSAGE_UPDATE\n                   * @param {AVMessage} message \n                   * @param {ConversationBase} conversation \n                   */\n                  this.emit(MESSAGE_UPDATE, message, conversation);\n                  /**\n                   * \n                   * @event ConversationBase#MESSAGE_UPDATE\n                   * @param {AVMessage} message \n                   */\n                  conversation.emit(MESSAGE_UPDATE, message);\n                }\n              });\n          }\n        )\n      )\n    );\n  }\n\n  async _dispatchConvMessage(message) {\n    const { convMessage, convMessage: { initBy, m, info, attr } } = message;\n    const conversation = await this.getConversation(convMessage.cid);\n    switch (message.op) {\n      case OpType.joined: {\n        if (!conversation.transient) {\n          // eslint-disable-next-line no-param-reassign\n          conversation.members = union(conversation.members, [this.id]);\n        }\n        const payload = {\n          invitedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#INVITED\n         * @param {Object} payload\n         * @param {String} payload.invitedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(INVITED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#INVITED\n         * @param {Object} payload\n         * @param {String} payload.invitedBy  id\n         */\n        conversation.emit(INVITED, payload);\n        return;\n      }\n      case OpType.left: {\n        if (!conversation.transient) {\n          // eslint-disable-next-line no-param-reassign\n          conversation.members = difference(conversation.members, [this.id]);\n        }\n        const payload = {\n          kickedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#KICKED\n         * @param {Object} payload\n         * @param {String} payload.kickedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(KICKED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#KICKED\n         * @param {Object} payload\n         * @param {String} payload.kickedBy  id\n         */\n        conversation.emit(KICKED, payload);\n        return;\n      }\n      case OpType.members_joined: {\n        if (!conversation.transient) {\n          // eslint-disable-next-line no-param-reassign\n          conversation.members = union(conversation.members, convMessage.m);\n        }\n        const payload = {\n          invitedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_JOINED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.invitedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_JOINED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_JOINED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.invitedBy  id\n         */\n        conversation.emit(MEMBERS_JOINED, payload);\n        return;\n      }\n      case OpType.members_left: {\n        if (!conversation.transient) {\n          // eslint-disable-next-line no-param-reassign\n          conversation.members = difference(\n            conversation.members,\n            convMessage.m\n          );\n        }\n        const payload = {\n          kickedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_LEFT\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.kickedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_LEFT, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_LEFT\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.kickedBy  id\n         */\n        conversation.emit(MEMBERS_LEFT, payload);\n        return;\n      }\n      case OpType.members_blocked: {\n        const payload = {\n          blockedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_BLOCKED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.blockedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_BLOCKED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_BLOCKED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.blockedBy  id\n         */\n        conversation.emit(MEMBERS_BLOCKED, payload);\n        return;\n      }\n      case OpType.members_unblocked: {\n        const payload = {\n          unblockedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_UNBLOCKED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.unblockedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_UNBLOCKED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_UNBLOCKED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.unblockedBy  id\n         */\n        conversation.emit(MEMBERS_UNBLOCKED, payload);\n        return;\n      }\n      case OpType.blocked: {\n        const payload = {\n          blockedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#BLOCKED\n         * @param {Object} payload\n         * @param {String} payloadblockedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(BLOCKED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#BLOCKED\n         * @param {Object} payload\n         * @param {String} payload.blockedBy  id\n         */\n        conversation.emit(BLOCKED, payload);\n        return;\n      }\n      case OpType.unblocked: {\n        const payload = {\n          unblockedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#UNBLOCKED\n         * @param {Object} payload\n         * @param {String} payload.unblockedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(UNBLOCKED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#UNBLOCKED\n         * @param {Object} payload\n         * @param {String} payload.unblockedBy  id\n         */\n        conversation.emit(UNBLOCKED, payload);\n        return;\n      }\n      case OpType.members_shutuped: {\n        const payload = {\n          mutedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_MUTED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.mutedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_MUTED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_MUTED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.mutedBy  id\n         */\n        conversation.emit(MEMBERS_MUTED, payload);\n        return;\n      }\n      case OpType.members_unshutuped: {\n        const payload = {\n          unmutedBy: initBy,\n          members: m,\n        };\n        /**\n         * \n         * @event IMClient#MEMBERS_UNMUTED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.unmutedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBERS_UNMUTED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBERS_UNMUTED\n         * @param {Object} payload\n         * @param {String[]} payload.members  id \n         * @param {String} payload.unmutedBy  id\n         */\n        conversation.emit(MEMBERS_UNMUTED, payload);\n        return;\n      }\n      case OpType.shutuped: {\n        const payload = {\n          mutedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#MUTED\n         * @param {Object} payload\n         * @param {String} payload.mutedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MUTED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MUTED\n         * @param {Object} payload\n         * @param {String} payload.mutedBy  id\n         */\n        conversation.emit(MUTED, payload);\n        return;\n      }\n      case OpType.unshutuped: {\n        const payload = {\n          unmutedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#UNMUTED\n         * @param {Object} payload\n         * @param {String} payload.unmutedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(UNMUTED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#UNMUTED\n         * @param {Object} payload\n         * @param {String} payload.unmutedBy  id\n         */\n        conversation.emit(UNMUTED, payload);\n        return;\n      }\n      case OpType.member_info_changed: {\n        const { pid, role } = info;\n        const { memberInfoMap } = internal(conversation);\n        //  role \n        if (!memberInfoMap && !role) return;\n        const memberInfo = await conversation.getMemberInfo(pid);\n        internal(memberInfo).role = role;\n        const payload = {\n          member: pid,\n          memberInfo,\n          updatedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#MEMBER_INFO_UPDATED\n         * @param {Object} payload\n         * @param {String[]} payload.member  id\n         * @param {ConversationMumberInfo} payload.memberInfo \n         * @param {String} payload.updatedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(MEMBER_INFO_UPDATED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#MEMBER_INFO_UPDATED\n         * @param {Object} payload\n         * @param {String[]} payload.member  id\n         * @param {ConversationMumberInfo} payload.memberInfo \n         * @param {String} payload.updatedBy  id\n         */\n        conversation.emit(MEMBER_INFO_UPDATED, payload);\n        return;\n      }\n      case OpType.updated: {\n        const attributes = decode(JSON.parse(attr.data));\n        conversation._updateServerAttributes(attributes);\n        const payload = {\n          attributes,\n          updatedBy: initBy,\n        };\n        /**\n         * \n         * @event IMClient#CONVERSATION_INFO_UPDATED\n         * @param {Object} payload\n         * @param {Object} payload.attributes \n         * @param {String} payload.updatedBy  id\n         * @param {ConversationBase} conversation\n         */\n        this.emit(CONVERSATION_INFO_UPDATED, payload, conversation);\n        /**\n         * \n         * @event ConversationBase#INFO_UPDATED\n         * @param {Object} payload\n         * @param {Object} payload.attributes \n         * @param {String} payload.updatedBy  id\n         */\n        conversation.emit(INFO_UPDATED, payload);\n        return;\n      }\n      default:\n        this.emit(UNHANDLED_MESSAGE, message);\n        throw new Error('Unrecognized conversation command');\n    }\n  }\n\n  _dispatchDirectMessage(originalMessage) {\n    const {\n      directMessage,\n      directMessage: {\n        id,\n        cid,\n        fromPeerId,\n        timestamp,\n        transient,\n        patchTimestamp,\n        mentionPids,\n        mentionAll,\n        binaryMsg,\n        msg,\n      },\n    } = originalMessage;\n    const content = binaryMsg ? binaryMsg.toArrayBuffer() : msg;\n    return Promise.all([\n      this.getConversation(directMessage.cid),\n      this._messageParser.parse(content),\n    ]).then(([conversation, message]) => {\n      // deleted conversation\n      if (!conversation) return undefined;\n      const messageProps = {\n        id,\n        cid,\n        timestamp,\n        updatedAt: patchTimestamp,\n        from: fromPeerId,\n        mentionList: mentionPids,\n        mentionedAll: mentionAll,\n      };\n      Object.assign(message, messageProps);\n      message._updateMentioned(this.id);\n      message._setStatus(MessageStatus.SENT);\n      // filter outgoing message sent from another device\n      if (message.from !== this.id) {\n        if (!(transient || conversation.transient)) {\n          this._sendAck(message);\n        }\n      }\n      return this._dispatchParsedMessage(message, conversation);\n    });\n  }\n\n  _dispatchParsedMessage(message, conversation) {\n    // beforeMessageDispatch hook\n    return applyDispatcher(this._plugins.beforeMessageDispatch, [\n      message,\n      conversation,\n    ]).then(shouldDispatch => {\n      if (shouldDispatch === false) return;\n      conversation.lastMessage = message; // eslint-disable-line no-param-reassign\n      conversation.lastMessageAt = message.timestamp; // eslint-disable-line no-param-reassign\n      // filter outgoing message sent from another device\n      if (message.from !== this.id) {\n        conversation.unreadMessagesCount += 1; // eslint-disable-line no-param-reassign\n        if (message.mentioned) conversation._setUnreadMessagesMentioned(true);\n      }\n      /**\n       * \n       * @event IMClient#MESSAGE\n       * @param {Message} message\n       * @param {ConversationBase} conversation \n       */\n      this.emit(MESSAGE, message, conversation);\n      /**\n       * \n       * @event ConversationBase#MESSAGE\n       * @param {Message} message\n       */\n      conversation.emit(MESSAGE, message);\n    });\n  }\n\n  _sendAck(message) {\n    this._debug('send ack for %O', message);\n    const { cid } = message;\n    if (!cid) {\n      throw new Error('missing cid');\n    }\n    if (!this._ackMessageBuffer[cid]) {\n      this._ackMessageBuffer[cid] = [];\n    }\n    this._ackMessageBuffer[cid].push(message);\n    return this._doSendAck();\n  }\n\n  // jsdoc-ignore-start\n  @throttle(1000)\n  // jsdoc-ignore-end\n  _doSendAck() {\n    // if not connected, just skip everything\n    if (!this._connection.is('connected')) return;\n    this._debug('do send ack %O', this._ackMessageBuffer);\n    Promise.all(\n      Object.keys(this._ackMessageBuffer).map(cid => {\n        const convAckMessages = this._ackMessageBuffer[cid];\n        const timestamps = convAckMessages.map(message => message.timestamp);\n        const command = new GenericCommand({\n          cmd: 'ack',\n          peerId: this.id,\n          ackMessage: new AckCommand({\n            cid,\n            fromts: Math.min.apply(null, timestamps),\n            tots: Math.max.apply(null, timestamps),\n          }),\n        });\n        delete this._ackMessageBuffer[cid];\n        return this._send(command, false).catch(error => {\n          this._debug('send ack failed: %O', error);\n          this._ackMessageBuffer[cid] = convAckMessages;\n        });\n      })\n    );\n  }\n\n  _omitPeerId(value) {\n    internal(this).peerIdOmittable = value;\n  }\n\n  _send(cmd, ...args) {\n    const command = cmd;\n    if (!internal(this).peerIdOmittable && this.id) {\n      command.peerId = this.id;\n    }\n    return this._connection.send(command, ...args);\n  }\n\n  async _open(appId, tag, deviceId, isReconnect = false) {\n    this._debug('open session');\n    const { lastUnreadNotifTime, lastPatchTime } = internal(this);\n    const command = new GenericCommand({\n      cmd: 'session',\n      op: 'open',\n      appId,\n      peerId: this.id,\n      sessionMessage: new SessionCommand({\n        ua: `js/${VERSION}`,\n        r: isReconnect,\n        lastUnreadNotifTime,\n        lastPatchTime,\n        configBitmap,\n      }),\n    });\n    if (!isReconnect) {\n      Object.assign(\n        command.sessionMessage,\n        trim({\n          tag,\n          deviceId,\n        })\n      );\n      if (this.options.signatureFactory) {\n        const signatureResult = await runSignatureFactory(\n          this.options.signatureFactory,\n          [this._identity]\n        );\n        Object.assign(\n          command.sessionMessage,\n          keyRemap(\n            {\n              signature: 's',\n              timestamp: 't',\n              nonce: 'n',\n            },\n            signatureResult\n          )\n        );\n      }\n    } else {\n      const sessionToken = await this._sessionManager.getSessionToken({\n        autoRefresh: false,\n      });\n      if (sessionToken && sessionToken !== Expirable.EXPIRED) {\n        Object.assign(command.sessionMessage, {\n          st: sessionToken,\n        });\n      }\n    }\n    let resCommand;\n    try {\n      resCommand = await this._send(command);\n    } catch (error) {\n      if (error.code === ErrorCode.SESSION_TOKEN_EXPIRED) {\n        if (!this._sessionManager) {\n          // let it fail if sessoinToken not cached but command rejected as token expired\n          // to prevent session openning flood\n          throw new Error('Unexpected session expiration');\n        }\n        debug('Session token expired, reopening');\n        this._sessionManager.revoke();\n        return this._open(appId, tag, deviceId, isReconnect);\n      }\n      throw error;\n    }\n    const {\n      peerId,\n      sessionMessage,\n      sessionMessage: { st: token, stTtl: tokenTTL, code },\n    } = resCommand;\n    if (code) {\n      throw createError(sessionMessage);\n    }\n    if (peerId) {\n      this.id = peerId;\n      if (!this._identity) this._identity = peerId;\n      if (token) {\n        this._sessionManager =\n          this._sessionManager || this._createSessionManager();\n        this._sessionManager.setSessionToken(token, tokenTTL);\n      }\n      if (internal(this).lastNotificationTime) {\n        // Do not await for it as this is failable\n        this._syncNotifications(internal(this).lastNotificationTime).catch(\n          error => console.warn('Syncing notifications failed:', error)\n        );\n      } else {\n        // Set timestamp to now for next reconnection\n        internal(this).lastNotificationTime = Date.now();\n      }\n    } else {\n      console.warn('Unexpected session opened without peerId.');\n    }\n    return undefined;\n  }\n\n  async _syncNotifications(timestamp) {\n    const { hasMore, notifications } = await this._fetchNotifications(\n      timestamp\n    );\n    notifications.forEach(notification => {\n      const { cmd, op, serverTs, ...payload } = notification;\n      this._dispatchCommand({\n        cmd: CommandType[cmd],\n        op: OpType[op],\n        serverTs,\n        [`${cmd}Message`]: payload,\n      });\n    });\n    if (hasMore) {\n      return this._syncNotifications(internal(this).lastNotificationTime);\n    }\n    return undefined;\n  }\n\n  async _fetchNotifications(timestamp) {\n    return this._requestWithSessionToken({\n      method: 'GET',\n      path: '/rtm/notifications',\n      query: {\n        start_ts: timestamp,\n        notification_type: 'permanent',\n      },\n    });\n  }\n\n  _createSessionManager() {\n    debug('create SessionManager');\n    return new SessionManager({\n      onBeforeGetSessionToken: this._connection.checkConnectionAvailability.bind(\n        this._connection\n      ),\n      refresh: (manager, expiredSessionToken) =>\n        manager.setSessionTokenAsync(\n          Promise.resolve(\n            new GenericCommand({\n              cmd: 'session',\n              op: 'refresh',\n              sessionMessage: new SessionCommand({\n                ua: `js/${VERSION}`,\n                st: expiredSessionToken,\n              }),\n            })\n          )\n            .then(async command => {\n              if (this.options.signatureFactory) {\n                const signatureResult = await runSignatureFactory(\n                  this.options.signatureFactory,\n                  [this._identity]\n                );\n                Object.assign(\n                  command.sessionMessage,\n                  keyRemap(\n                    {\n                      signature: 's',\n                      timestamp: 't',\n                      nonce: 'n',\n                    },\n                    signatureResult\n                  )\n                );\n              }\n              return command;\n            })\n            .then(this._send.bind(this))\n            .then(({ sessionMessage: { st: token, stTtl: ttl } }) => [\n              token,\n              ttl,\n            ])\n        ),\n    });\n  }\n\n  async _requestWithSessionToken({ headers, query, ...params }) {\n    const sessionToken = await this._sessionManager.getSessionToken();\n    return this._request({\n      headers: {\n        'X-LC-IM-Session-Token': sessionToken,\n        ...headers,\n      },\n      query: {\n        client_id: this.id,\n        ...query,\n      },\n      ...params,\n    });\n  }\n\n  /**\n   * \n   * @return {Promise}\n   */\n  async close() {\n    this._debug('close session');\n    const _ee = internal(this)._eventemitter;\n    _ee.emit('beforeclose');\n    if (this._connection.is('connected')) {\n      const command = new GenericCommand({\n        cmd: 'session',\n        op: 'close',\n      });\n      await this._send(command);\n    }\n    _ee.emit('close');\n    this.emit(CLOSE, {\n      code: 0,\n    });\n  }\n  /**\n   *  client  client 20  clientId\n   * @param  {String[]} clientIds  client ids\n   * @return {Primse.<String[]>}  client ids\n   */\n  async ping(clientIds) {\n    this._debug('ping');\n    if (!(clientIds instanceof Array)) {\n      throw new TypeError(`clientIds ${clientIds} is not an Array`);\n    }\n    if (!clientIds.length) {\n      return Promise.resolve([]);\n    }\n    const command = new GenericCommand({\n      cmd: 'session',\n      op: 'query',\n      sessionMessage: new SessionCommand({\n        sessionPeerIds: clientIds,\n      }),\n    });\n    const resCommand = await this._send(command);\n    return resCommand.sessionMessage.onlineSessionPeerIds;\n  }\n\n  /**\n   * \n   * @param  {String} id  id _Conversation  objectId\n   * @param  {Boolean} [noCache=false] \n   * @return {Promise.<ConversationBase>}  id  null\n   */\n  async getConversation(id, noCache = false) {\n    if (typeof id !== 'string') {\n      throw new TypeError(`${id} is not a String`);\n    }\n    if (!noCache) {\n      const cachedConversation = this._conversationCache.get(id);\n      if (cachedConversation) {\n        return cachedConversation;\n      }\n    }\n    if (isTemporaryConversatrionId(id)) {\n      return (await this._getTemporaryConversations([id]))[0] || null;\n    }\n    return this.getQuery()\n      .equalTo('objectId', id)\n      .find()\n      .then(conversations => conversations[0] || null);\n  }\n\n  /**\n   *  id \n   * @since 3.4.0\n   * @param  {String[]} ids  id  _Conversation  objectId\n   * @param  {Boolean} [noCache=false] \n   * @return {Promise.<ConversationBase[]>}  id  null\n   */\n  async getConversations(ids, noCache = false) {\n    const remoteConversationIds = noCache\n      ? ids\n      : ids.filter(id => this._conversationCache.get(id) === null);\n    if (remoteConversationIds.length) {\n      const remoteTemporaryConversationIds = remove(\n        remoteConversationIds,\n        isTemporaryConversatrionId\n      );\n      const query = [];\n      if (remoteConversationIds.length) {\n        query.push(\n          this.getQuery()\n            .containedIn('objectId', remoteConversationIds)\n            .limit(999)\n            .find()\n        );\n      }\n      if (remoteTemporaryConversationIds.length) {\n        const remoteTemporaryConversationsPromise = remoteTemporaryConversationIds.map(\n          this._getTemporaryConversations.bind(this)\n        );\n        query.push(...remoteTemporaryConversationsPromise);\n      }\n      await Promise.all(query);\n    }\n    return ids.map(id => this._conversationCache.get(id));\n  }\n\n  async _getTemporaryConversations(ids) {\n    const command = new GenericCommand({\n      cmd: 'conv',\n      op: 'query',\n      convMessage: new ConvCommand({\n        tempConvIds: ids,\n      }),\n    });\n    const resCommand = await this._send(command);\n    return this._handleQueryResults(resCommand);\n  }\n\n  /**\n   *  ConversationQuery \n   * @return {ConversationQuery.<PersistentConversation>}\n   */\n  getQuery() {\n    return new ConversationQuery(this);\n  }\n\n  /**\n   *  ConversationQuery \n   * @return {ConversationQuery.<ChatRoom>}\n   */\n  getChatRoomQuery() {\n    return this.getQuery().equalTo('tr', true);\n  }\n\n  /**\n   *  ConversationQuery \n   * @return {ConversationQuery.<ServiceConversation>}\n   */\n  getServiceConversationQuery() {\n    return this.getQuery().equalTo('sys', true);\n  }\n\n  async _executeQuery(query) {\n    const queryJSON = query.toJSON();\n    queryJSON.where = new JsonObjectMessage({\n      data: JSON.stringify(encode(queryJSON.where)),\n    });\n    const command = new GenericCommand({\n      cmd: 'conv',\n      op: 'query',\n      convMessage: new ConvCommand(queryJSON),\n    });\n    const resCommand = await this._send(command);\n    return this._handleQueryResults(resCommand);\n  }\n\n  async _handleQueryResults(resCommand) {\n    let conversations;\n    try {\n      conversations = decode(JSON.parse(resCommand.convMessage.results.data));\n    } catch (error) {\n      const commandString = JSON.stringify(trim(resCommand));\n      throw new Error(\n        `Parse query result failed: ${error.message}. Command: ${commandString}`\n      );\n    }\n    conversations = await Promise.all(\n      conversations.map(this._parseConversationFromRawData.bind(this))\n    );\n    return conversations.map(this._upsertConversationToCache.bind(this));\n  }\n\n  _upsertConversationToCache(fetchedConversation) {\n    let conversation = this._conversationCache.get(fetchedConversation.id);\n    if (!conversation) {\n      conversation = fetchedConversation;\n      this._debug('no match, set cache');\n      this._conversationCache.set(fetchedConversation.id, fetchedConversation);\n    } else {\n      this._debug('update cached conversation');\n      [\n        'creator',\n        'createdAt',\n        'updatedAt',\n        'lastMessageAt',\n        'lastMessage',\n        'mutedMembers',\n        'members',\n        '_attributes',\n        'transient',\n        'muted',\n      ].forEach(key => {\n        const value = fetchedConversation[key];\n        if (value !== undefined) conversation[key] = value;\n      });\n      if (conversation._reset) conversation._reset();\n    }\n    return conversation;\n  }\n\n  /**\n   *  {@link Message#toFullJSON} \n   * @param {Object}\n   * @return {AVMessage} \n   * @since 4.0.0\n   */\n  async parseMessage({ data, bin = false, ...properties }) {\n    const content = bin ? decodeBase64(data) : data;\n    const message = await this._messageParser.parse(content);\n    Object.assign(message, properties);\n    message._updateMentioned(this.id);\n    return message;\n  }\n\n  /**\n   *  {@link Conversation#toFullJSON} \n   * @param {Object}\n   * @return {ConversationBase} \n   * @since 4.0.0\n   */\n  async parseConversation({\n    id,\n    lastMessageAt,\n    lastMessage,\n    lastDeliveredAt,\n    lastReadAt,\n    unreadMessagesCount,\n    members,\n    mentioned,\n    ...properties\n  }) {\n    const conversationData = {\n      id,\n      lastMessageAt,\n      lastMessage,\n      lastDeliveredAt,\n      lastReadAt,\n      unreadMessagesCount,\n      members,\n      mentioned,\n    };\n    if (lastMessage) {\n      conversationData.lastMessage = await this.parseMessage(lastMessage);\n      conversationData.lastMessage._setStatus(MessageStatus.SENT);\n    }\n    const { transient, system, expiredAt } = properties;\n    if (transient) return new ChatRoom(conversationData, properties, this);\n    if (system)\n      return new ServiceConversation(conversationData, properties, this);\n    if (expiredAt || isTemporaryConversatrionId(id)) {\n      return new TemporaryConversation(conversationData, { expiredAt }, this);\n    }\n    return new Conversation(conversationData, properties, this);\n  }\n\n  async _parseConversationFromRawData(rawData) {\n    const data = keyRemap(\n      {\n        objectId: 'id',\n        lm: 'lastMessageAt',\n        m: 'members',\n        tr: 'transient',\n        sys: 'system',\n        c: 'creator',\n        mu: 'mutedMembers',\n      },\n      rawData\n    );\n    if (data.msg) {\n      data.lastMessage = {\n        data: data.msg,\n        bin: data.bin,\n        from: data.msg_from,\n        id: data.msg_mid,\n        timestamp: data.msg_timestamp,\n        updatedAt: data.patch_timestamp,\n      };\n      delete data.lastMessageFrom;\n      delete data.lastMessageId;\n      delete data.lastMessageTimestamp;\n      delete data.lastMessagePatchTimestamp;\n    }\n    const { ttl } = data;\n    if (ttl) data.expiredAt = Date.now() + ttl * 1000;\n    return this.parseConversation(data);\n  }\n\n  /**\n   * \n   * @param {Object} options \n   * @param {String[]} options.members  client\n   * @param {String} [options.name] \n   * @param {Boolean} [options.unique=false]  true \n   * @return {Promise.<Conversation>}\n   */\n  async createConversation({\n    members: m,\n    name,\n    transient,\n    unique,\n    _tempConv: tempConv,\n    _tempConvTTL: tempConvTTL,\n    ...properties\n  } = {}) {\n    if (!(transient || Array.isArray(m))) {\n      throw new TypeError(`conversation members ${m} is not an array`);\n    }\n    let members = new Set(m);\n    members.add(this.id);\n    members = Array.from(members).sort();\n    let attr = properties || {};\n    if (name) {\n      if (typeof name !== 'string') {\n        throw new TypeError(`conversation name ${name} is not a string`);\n      }\n      attr.name = name;\n    }\n    attr = new JsonObjectMessage({\n      data: JSON.stringify(encode(attr)),\n    });\n\n    const startCommandJson = {\n      m: members,\n      attr,\n      transient,\n      unique,\n      tempConv,\n      tempConvTTL,\n    };\n\n    const command = new GenericCommand({\n      cmd: 'conv',\n      op: 'start',\n      convMessage: new ConvCommand(startCommandJson),\n    });\n\n    if (this.options.conversationSignatureFactory) {\n      const params = [null, this._identity, members, 'create'];\n      const signatureResult = await runSignatureFactory(\n        this.options.conversationSignatureFactory,\n        params\n      );\n      Object.assign(\n        command.convMessage,\n        keyRemap(\n          {\n            signature: 's',\n            timestamp: 't',\n            nonce: 'n',\n          },\n          signatureResult\n        )\n      );\n    }\n\n    const { convMessage: { cid, cdate, tempConvTTL: ttl } } = await this._send(\n      command\n    );\n    const data = {\n      name,\n      transient,\n      unique,\n      id: cid,\n      createdAt: cdate,\n      updatedAt: cdate,\n      lastMessageAt: null,\n      creator: this.id,\n      members: transient ? [] : members,\n      ...properties,\n    };\n    if (ttl) data.expiredAt = Date.now() + ttl * 1000;\n    const conversation = await this.parseConversation(data);\n    return this._upsertConversationToCache(conversation);\n  }\n\n  /**\n   * \n   * @since 4.0.0\n   * @param {Object} options \n   * @param {String} [options.name] \n   * @return {Promise.<ChatRoom>}\n   */\n  async createChatRoom(param) {\n    return this.createConversation({\n      ...param,\n      transient: true,\n      members: null,\n      unique: false,\n    });\n  }\n\n  /**\n   * \n   * @since 4.0.0\n   * @param {Object} options\n   * @param {String[]} options.members  client\n   * @param {String} [options.ttl]  86400\n   * @return {Promise.<TemporaryConversation>}\n   */\n  async createTemporaryConversation({ ttl: _tempConvTTL, ...param }) {\n    return this.createConversation({\n      ...param,\n      transient: false,\n      unique: false,\n      _tempConv: true,\n      _tempConvTTL,\n    });\n  }\n\n  // jsdoc-ignore-start\n  @throttle(1000)\n  // jsdoc-ignore-end\n  _doSendRead() {\n    // if not connected, just skip everything\n    if (!this._connection.is('connected')) return;\n    const buffer = internal(this).readConversationsBuffer;\n    const conversations = Array.from(buffer);\n    if (!conversations.length) return;\n    const ids = conversations.map(conversation => {\n      if (!(conversation instanceof ConversationBase)) {\n        throw new TypeError(`${conversation} is not a Conversation`);\n      }\n      return conversation.id;\n    });\n    this._debug(`mark [${ids}] as read`);\n    buffer.clear();\n    this._sendReadCommand(conversations).catch(error => {\n      this._debug('send read failed: %O', error);\n      conversations.forEach(buffer.add.bind(buffer));\n    });\n  }\n  _sendReadCommand(conversations) {\n    return this._send(\n      new GenericCommand({\n        cmd: 'read',\n        readMessage: new ReadCommand({\n          convs: conversations.map(\n            conversation =>\n              new ReadTuple({\n                cid: conversation.id,\n                mid:\n                  conversation.lastMessage &&\n                  conversation.lastMessage.from !== this.id\n                    ? conversation.lastMessage.id\n                    : undefined,\n                timestamp: (conversation.lastMessageAt || new Date()).getTime(),\n              })\n          ),\n        }),\n      }),\n      false\n    );\n  }\n}\n","export {\n  DISCONNECT,\n  RECONNECT,\n  RETRY,\n  SCHEDULE,\n  OFFLINE,\n  ONLINE,\n} from '../websocket-plus';\n\nexport const RECONNECT_ERROR = 'reconnecterror';\n","import { encode as encodeBase64 } from 'base64-arraybuffer';\nimport Message from './message';\nimport { IE10Compatible } from './helpers';\n// jsdoc-ignore-start\n@IE10Compatible\n// jsdoc-ignore-end\nexport default class BinaryMessage extends Message {\n  /**\n   * \n   * @extends Message\n   * @param {ArrayBuffer} buffer\n   * @since 4.0.0\n   */\n  constructor(buffer) {\n    if (!(buffer instanceof ArrayBuffer)) {\n      throw new TypeError(`${buffer} is not an ArrayBuffer`);\n    }\n    super(buffer);\n  }\n\n  /**\n   * @type ArrayBuffer\n   */\n  get buffer() {\n    return this.content;\n  }\n  set buffer(buffer) {\n    this.content = buffer;\n  }\n\n  static validate(target) {\n    return target instanceof ArrayBuffer;\n  }\n\n  toJSON() {\n    return {\n      ...super._toJSON(),\n      data: encodeBase64(this.content),\n    };\n  }\n\n  toFullJSON() {\n    return {\n      ...super.toFullJSON(),\n      bin: true,\n      data: encodeBase64(this.content),\n    };\n  }\n}\n","import TypedMessage from './typed-message';\nimport { messageType, IE10Compatible } from './helpers';\n\n// jsdoc-ignore-start\n@messageType(-1)\n@IE10Compatible\n// jsdoc-ignore-end\nexport default class TextMessage extends TypedMessage {\n  /**\n   * \n   * @extends TypedMessage\n   * @param  {String} [text='']\n   * @throws {TypeError} text  String \n   */\n  constructor(text = '') {\n    if (typeof text !== 'string') {\n      throw new TypeError(`${text} is not a string`);\n    }\n    super();\n    this.setText(text);\n  }\n}\n\n/**\n * @name TYPE\n * @memberof TextMessage\n * @type Number\n * @static\n * @const\n */\n","import d from 'debug';\nimport isPlainObject from 'lodash/isPlainObject';\nimport { applyMiddlewares } from './plugin';\n\nconst debug = d('LC:MessageParser');\n\nconst tryParseJson = (target, key, descriptor) => {\n  const fn = descriptor.value;\n  // eslint-disable-next-line no-param-reassign\n  descriptor.value = function wrapper(param) {\n    let content;\n    if (typeof param !== 'string') {\n      content = param;\n    } else {\n      try {\n        content = JSON.parse(param);\n      } catch (error) {\n        content = param;\n      }\n    }\n    return fn.call(this, content);\n  };\n};\n\nconst applyPlugins = (target, key, descriptor) => {\n  const fn = descriptor.value;\n  // eslint-disable-next-line no-param-reassign\n  descriptor.value = function wrapper(json) {\n    return Promise.resolve(json)\n      .then(applyMiddlewares(this._plugins.beforeMessageParse))\n      .then(decoratedJson => fn.call(this, decoratedJson))\n      .then(applyMiddlewares(this._plugins.afterMessageParse));\n  };\n};\n\nexport default class MessageParser {\n  constructor(plugins = {}) {\n    this._plugins = plugins;\n    this._messageClasses = [];\n  }\n\n  register(messageClass) {\n    if (\n      messageClass &&\n      messageClass.parse &&\n      messageClass.prototype &&\n      messageClass.prototype.getPayload\n    ) {\n      this._messageClasses.unshift(messageClass);\n    } else {\n      throw new TypeError('Invalid messageClass');\n    }\n  }\n\n  // jsdoc-ignore-start\n  @tryParseJson\n  @applyPlugins\n  // jsdoc-ignore-end\n  parse(content) {\n    debug('parsing message: %O', content);\n    // eslint-disable-next-line no-restricted-syntax\n    for (const Klass of this._messageClasses) {\n      const contentCopy = isPlainObject(content)\n        ? Object.assign({}, content)\n        : content;\n      let valid;\n      let result;\n      try {\n        valid = Klass.validate(contentCopy);\n      } catch (error) {\n        // eslint-disable-line no-empty\n      }\n      if (valid) {\n        try {\n          result = Klass.parse(contentCopy);\n        } catch (error) {\n          console.warn('parsing a valid message content error', {\n            error,\n            Klass,\n            content: contentCopy,\n          });\n        }\n        if (result !== undefined) {\n          debug('parse result: %O', result);\n          return result;\n        }\n      }\n    }\n    throw new Error('No Message Class matched');\n  }\n}\n","/** @module leancloud-realtime */\nimport d from 'debug';\nimport uuid from 'uuid/v4';\nimport IMClient from './im-client';\nimport { RECONNECT, RECONNECT_ERROR } from './events/core';\nimport { Conversation } from './conversations';\nimport { MessageQueryDirection } from './conversations/conversation-base';\nimport Message, { MessageStatus } from './messages/message';\nimport BinaryMessage from './messages/binary-message';\nimport TextMessage from './messages/text-message';\nimport TypedMessage from './messages/typed-message';\nimport RecalledMessage from './messages/recalled-message';\nimport MessageParser from './message-parser';\nimport { trim, internal, ensureArray } from './utils';\n\nconst debug = d('LC:IMPlugin');\n\n/**\n * \n * @enum {Number}\n * @since 3.3.0\n */\nconst MessagePriority = {\n  /**  */\n  HIGH: 1,\n  /**  */\n  NORMAL: 2,\n  /**  */\n  LOW: 3,\n};\nObject.freeze(MessagePriority);\n\n/**\n *  Conversation \n * @param {String} prop \n * @param {Object} [descriptor]  {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor#Description getOwnPropertyDescriptor#Description - MDN} Conversation  getter/setter\n * @returns void\n * @example\n *\n * conversation.get('type');\n * conversation.set('type', 1);\n *\n * // equals to\n * defineConversationProperty('type');\n * conversation.type;\n * conversation.type = 1;\n */\nconst defineConversationProperty = (\n  prop,\n  descriptor = {\n    get() {\n      return this.get(prop);\n    },\n    set(value) {\n      this.set(prop, value);\n    },\n  }\n) => {\n  Object.defineProperty(Conversation.prototype, prop, descriptor);\n};\n\nexport {\n  /**\n   * @see Message\n   */\n  Message,\n  /**\n   * @see BinaryMessage\n   */\n  BinaryMessage,\n  /**\n   * @see TypedMessage\n   */\n  TypedMessage,\n  /**\n   * @see TextMessage\n   */\n  TextMessage,\n  /**\n   * @see RecalledMessage\n   */\n  RecalledMessage,\n  MessagePriority,\n  MessageStatus,\n  MessageQueryDirection,\n  defineConversationProperty,\n};\n\nexport {\n  /**\n   * decorator\n   * @function\n   * @param {Number} type \n   * @example @messageType(1)\n   * class CustomMessage extends TypedMessage {}\n   *\n   * //  decorator \n   * class CustomMessage extends TypedMessage {\n   *   //...\n   * }\n   * messageType(1)(CustomMessage);\n   */\n  messageType,\n  /**\n   * decorator\n   * @function\n   * @param {String[]} fields \n   * @example @messageField(['foo'])\n   * class CustomMessage extends TypedMessage {\n   *   constructor(foo) {\n   *     super();\n   *     this.foo = foo;\n   *   }\n   * }\n   *\n   * //  decorator \n   * class CustomMessage extends TypedMessage {\n   *   constructor(foo) {\n   *     super();\n   *     this.foo = foo;\n   *   }\n   *   //...\n   * }\n   * messageField(['foo'])(CustomMessage);\n   */\n  messageField,\n  IE10Compatible,\n} from './messages/helpers';\n\nexport { ConversationMemberRole } from './conversation-member-info';\nexport {\n  /**\n   * @see Conversation\n   */\n  Conversation,\n  /**\n   * @see ChatRoom\n   */\n  ChatRoom,\n  /**\n   * @see ServiceConversation\n   */\n  ServiceConversation,\n  /**\n   * @see TemporaryConversation\n   */\n  TemporaryConversation,\n} from './conversations';\n\nconst onRealtimeCreate = realtime => {\n  /* eslint-disable no-param-reassign */\n  const deviceId = uuid();\n  realtime._IMClients = {};\n  realtime._IMClientsCreationCount = 0;\n  const messageParser = new MessageParser(realtime._plugins);\n  realtime._messageParser = messageParser;\n\n  const signAVUser = async user =>\n    realtime._request({\n      method: 'POST',\n      path: '/rtm/sign',\n      data: {\n        session_token: user.getSessionToken(),\n      },\n    });\n\n  /**\n   * \n   *\n   * \n   *\n   * @memberof Realtime\n   * @instance\n   * @param  {Function | Function[]} messageClass  {@link AVMessage} \n   *  {@link TypedMessage}\n   * @throws {TypeError}  messageClass  {@link AVMessage} \n   */\n  const register = messageClass =>\n    ensureArray(messageClass).map(messageParser.register.bind(messageParser));\n  register(ensureArray(realtime._plugins.messageClasses));\n  /**\n   *  id \n   * @memberof Realtime\n   * @instance\n   * @param  {String|AV.User} [identity]  identity identity\n   *  AV.User id  identity \n   * @param  {Object} [options]\n   * @param  {Function} [options.signatureFactory] open session  // TODO need details\n   * @param  {Function} [options.conversationSignatureFactory] \n   * @param  {Function} [options.blacklistSignatureFactory] \n   * @param  {String} [options.tag] \n   * @param  {String} [options.isReconnect=false] \n   * @return {Promise.<IMClient>}\n   */\n  const createIMClient = async (\n    identity,\n    { tag, isReconnect, ...clientOptions } = {},\n    lagecyTag\n  ) => {\n    let id;\n    const buildinOptions = {};\n    if (identity) {\n      if (typeof identity === 'string') {\n        id = identity;\n      } else if (identity.id && identity.getSessionToken) {\n        ({ id } = identity);\n        const sessionToken = identity.getSessionToken();\n        if (!sessionToken) {\n          throw new Error('User must be authenticated');\n        }\n        buildinOptions.signatureFactory = signAVUser;\n      } else {\n        throw new TypeError('Identity must be a String or an AV.User');\n      }\n      if (realtime._IMClients[id] !== undefined) {\n        return realtime._IMClients[id];\n      }\n    }\n    if (lagecyTag) {\n      console.warn(\n        'DEPRECATION createIMClient tag param: Use options.tag instead.'\n      );\n    }\n    const _tag = tag || lagecyTag;\n    const promise = realtime\n      ._open()\n      .then(connection => {\n        const client = new IMClient(\n          id,\n          { ...buildinOptions, ...clientOptions },\n          {\n            _connection: connection,\n            _request: realtime._request.bind(realtime),\n            _messageParser: messageParser,\n            _plugins: realtime._plugins,\n            _identity: identity,\n          }\n        );\n        connection.on(RECONNECT, () =>\n          client\n            ._open(realtime._options.appId, _tag, deviceId, true)\n            /**\n             *  {@link Realtime#event:RECONNECT} \n             * @event IMClient#RECONNECT\n             * @see Realtime#event:RECONNECT\n             * @since 3.2.0\n             */\n            /**\n             * \n             * @event IMClient#RECONNECT_ERROR\n             * @since 3.2.0\n             */\n            .then(\n              () => client.emit(RECONNECT),\n              error => client.emit(RECONNECT_ERROR, error)\n            )\n        );\n        internal(client)._eventemitter.on(\n          'beforeclose',\n          () => {\n            delete realtime._IMClients[client.id];\n            if (realtime._firstIMClient === client) {\n              delete realtime._firstIMClient;\n            }\n          },\n          realtime\n        );\n        internal(client)._eventemitter.on(\n          'close',\n          () => {\n            realtime._deregister(client);\n          },\n          realtime\n        );\n        return client\n          ._open(realtime._options.appId, _tag, deviceId, isReconnect)\n          .then(() => {\n            realtime._IMClients[client.id] = client;\n            realtime._IMClientsCreationCount += 1;\n            if (realtime._IMClientsCreationCount === 1) {\n              client._omitPeerId(true);\n              realtime._firstIMClient = client;\n            } else if (\n              realtime._IMClientsCreationCount > 1 &&\n              realtime._firstIMClient\n            ) {\n              realtime._firstIMClient._omitPeerId(false);\n            }\n            realtime._register(client);\n            return client;\n          })\n          .catch(error => {\n            delete realtime._IMClients[client.id];\n            throw error;\n          });\n      })\n      .finally(() => {\n        realtime._deregisterPending(promise);\n      });\n    if (identity) {\n      realtime._IMClients[id] = promise;\n    }\n    realtime._registerPending(promise);\n    return promise;\n  };\n  Object.assign(realtime, {\n    register,\n    createIMClient,\n  });\n  /* eslint-enable no-param-reassign */\n};\n\nconst beforeCommandDispatch = (command, realtime) => {\n  const isIMCommand = command.service === null || command.service === 2;\n  if (!isIMCommand) return true;\n  const targetClient = command.peerId\n    ? realtime._IMClients[command.peerId]\n    : realtime._firstIMClient;\n  if (targetClient) {\n    Promise.resolve(targetClient)\n      .then(client => client._dispatchCommand(command))\n      .catch(debug);\n  } else {\n    debug(\n      '[WARN] Unexpected message received without any live client match: %O',\n      trim(command)\n    );\n  }\n  return false;\n};\n\nexport const IMPlugin = {\n  name: 'leancloud-realtime-plugin-im',\n  onRealtimeCreate,\n  beforeCommandDispatch,\n  messageClasses: [Message, BinaryMessage, RecalledMessage, TextMessage],\n};\n","import { Realtime } from './core';\nimport { IMPlugin, defineConversationProperty } from './plugin-im';\nimport * as CoreEvent from './events/core';\nimport * as IMEvent from './events/im';\n\nRealtime.defineConversationProperty = defineConversationProperty;\nRealtime.__preRegisteredPlugins = [IMPlugin];\n\nconst Event = {\n  ...CoreEvent,\n  ...IMEvent,\n};\n\nexport {\n  /**\n   * SDK \n   * @name Event\n   * @memberof module:leancloud-realtime\n   * @enum {String}\n   * @since 4.0.0\n   */\n  Event,\n};\n\nexport {\n  /**\n   *  {@link https://leancloud.cn/docs/realtime_v2.html#}\n   * @name ErrorCode\n   * @memberof module:leancloud-realtime\n   * @enum {Number}\n   * @since 3.3.0\n   */\n  ErrorCode,\n} from './error';\n\nexport * from './core';\n\nexport * from './plugin-im';\n"],"names":["module","require","newBuilder","build","messages","push_server","messages2","JsonObjectMessage","UnreadTuple","LogItem","DataCommand","SessionCommand","ErrorCommand","DirectCommand","AckCommand","UnreadCommand","ConvCommand","RoomCommand","LogsCommand","RcpCommand","ReadTuple","MaxReadTuple","ReadCommand","PresenceCommand","ReportCommand","GenericCommand","BlacklistCommand","PatchCommand","PatchItem","ConvMemberInfo","CommandType","OpType","StatusType","global","window","EXPIRED","debug","d","Expirable","value","ttl","originalValue","expiredAt","Date","now","expired","Cache","name","_map","get","key","cache","set","tryAll","promise","promiseConstructors","length","catch","slice","tap","interceptor","decodeDate","date","__type","iso","toNumber","getTime","undefined","decode","isPlainObject","reduce","result","encode","toJSON","keyRemap","keymap","obj","newObj","newKey","isIE10","navigator","userAgent","indexOf","getStaticProperty","klass","property","__proto__","union","a","b","difference","filter","bSet","has","x","map","internal","object","compact","prop","hasOwnProperty","call","removeNull","trim","JSON","parse","message","ensureArray","Array","isArray","target","setValue","segs","split","lastSeg","pop","currentTarget","forEach","seg","isWeapp","wx","connectSocket","throttle","descriptor","callback","Error","throttleMeta","propertyMeta","previouseTimestamp","timeout","remainingTime","wait","apply","setTimeout","OPEN","DISCONNECT","RECONNECT","RETRY","SCHEDULE","OFFLINE","ONLINE","ERROR","MESSAGE","HEARTBEAT_TIME","TIMEOUT_TIME","DEFAULT_RETRY_STRATEGY","Math","min","attempt","requireConnected","requireConnectedWrapper","checkConnectionAvailability","args","WebSocketPlus","getUrls","protocol","WebSocket","init","_protocol","resolve","then","_urls","urls","_open","__postponeTimeoutTimer","_postponeTimeoutTimer","bind","addEventListener","__pause","pause","__resume","resume","open","throw","_createWs","first","reset","ws","reject","url","binaryType","onopen","onclose","error","onerror","_ws","_handleClose","onmessage","_handleMessage","_destroyWs","close","onbeforeevent","event","from","to","payload","emit","onconnected","_startConnectionKeeper","onleaveconnected","_stopConnectionKeeper","onpause","onbeforeresume","onreconnect","ondisconnected","delay","__scheduledRetry","is","retry","onretry","can","reconnect","fail","removeEventListener","currentState","current","warn","_ping","ping","_clearTimeoutTimers","_timeoutTimer","disconnect","_heartbeatTimer","setInterval","addListener","removeListener","code","reason","isFinished","handleClose","send","data","handleMessage","EventEmitter","StateMachine","create","prototype","ErrorCode","Number","createError","appCode","detail","errorMessage","err","COMMAND_TIMEOUT","Connection","getUrl","format","version","protocolString","encodeURIComponent","_protocalFormat","_commands","_serialId","command","waitingForRespond","i","serialId","enabled","toBase64","toArrayBuffer","TypeError","cmd","op","msg","e","echo","checkType","constructor","param","middleware","console","_pluginName","applyDecorators","decorators","decorator","applyMiddlewares","middlewares","previousPromise","applyDispatcher","dispatchers","resultPromise","dispatcher","shouldDispatch","debugRequest","routerCache","Realtime","plugins","options","VERSION","appId","appKey","_options","process","env","RTM_SERVER_NAME","_cache","_this","clients","pendingClients","mergedPlugins","__preRegisteredPlugins","plugin","_plugins","hook","concat","onRealtimeCreate","_request","method","path","query","headers","region","_getServerUrls","api","axios","response","status","_openPromise","noBinary","pushOfflineMessages","connection","_getRTMServers","on","_dispatchCommand","isFatal","APP_NOT_AVAILABLE","INVALID_LOGIN","INVALID_ORIGIN","some","errorCode","RTMServers","shuffle","cachedEndPoints","_fetchRTMServers","info","server","secondary","cachedRouter","res","RTMRouter","rtm_router_server","api_server","serverUrls","id","toLowerCase","ssl","RTMServerName","_close","cannot","_registerPending","add","_deregisterPending","client","delete","_register","_deregister","size","beforeCommandDispatch","INVITED","KICKED","MEMBERS_JOINED","MEMBERS_LEFT","MEMBER_INFO_UPDATED","BLOCKED","UNBLOCKED","MEMBERS_BLOCKED","MEMBERS_UNBLOCKED","MUTED","UNMUTED","MEMBERS_MUTED","MEMBERS_UNMUTED","UNREAD_MESSAGES_COUNT_UPDATE","CLOSE","CONFLICT","UNHANDLED_MESSAGE","CONVERSATION_INFO_UPDATED","LAST_DELIVERED_AT_UPDATE","LAST_READ_AT_UPDATE","MESSAGE_RECALL","MESSAGE_UPDATE","INFO_UPDATED","MessageStatus","rMessageStatus","NONE","SENDING","SENT","DELIVERED","READ","FAILED","Message","content","uuid","_setStatus","getPayload","_toJSON","cid","timestamp","deliveredAt","updatedAt","mentionList","mentionedAll","mentioned","toFullJSON","_updatedAt","_status","_updateMentioned","_mentioned","getMentionList","setMentionList","mentionAll","Boolean","validate","json","_timestamp","_deliveredAt","messageType","type","TYPE","_lctype","_getType","messageField","fields","originalCustomFields","_customFields","IE10Compatible","TypedMessage","setText","text","_lctext","getText","setAttributes","attributes","_lcattrs","getAttributes","_getCustomFields","field","summary","customFields","RecalledMessage","serializeMessage","binaryMsg","ArrayBuffer","QueryDirection","NEW","OLD","MessageQueryDirection","ConversationBase","lastMessageAt","lastMessage","lastDeliveredAt","lastReadAt","unreadMessagesCount","members","properties","IMClient","_client","Event","_debug","onConversationCreate","_setUnreadMessagesMentioned","unreadMessagesMentioned","_setLastDeliveredAt","_setLastReadAt","params","_send","convMessage","sendOptions","getSendOptions","transient","receipt","priority","pushData","will","resCommand","ackMessage","uid","t","messagesWaitingForReceipt","_update","newMessage","recall","patch","modify","_lastPatchTime","count","update","queryMessages","beforeTime","beforeMessageId","afterTime","afterMessageId","limit","direction","startTime","startMessageId","startClosed","endTime","endMessageId","endClosed","conditions","tt","OLD_TO_NEW","all","logsMessage","logs","msgId","patchTimestamp","ackAt","readAt","mentionPids","bin","parseMessage","messageData","createMessagesIterator","prevMessages","read","readConversationsBuffer","_doSendRead","_handleReceipt","messageId","fetchReceiptTimestamps","maxReadTimestamp","maxAckTimestamp","_fetchAllReceiptTimestamps","maxReadTuples","maxReadTuple","pid","time","_lastMessageAt","ConversationMemberRole","ConversationMemberInfo","conversation","memberId","role","conversationId","isOwner","creator","_validateSignature","signatureResult","signature","nonce","signatureFactory","createPartiallySuccess","allowedPids","failedPids","pids","clientIds","PersistentConversation","createdAt","system","muted","mutedMembers","_reset","currentAttributes","pendingAttributes","pendingKeys","re","RegExp","childKeys","test","k","parentKey","_buildCurrentAttributes","cloneDeep","_attributes","_updateServerAttributes","save","isEmpty","attr","udate","fetch","getQuery","equalTo","find","mute","unmute","_appendConversationSignature","action","conversationSignatureFactory","sort","runSignatureFactory","_appendBlacklistSignature","blacklistSignatureFactory","blacklistMessage","remove","join","failures","quit","muteMembers","add_shutup","unmuteMembers","remove_shutup","queryMutedMembers","next","query_shutup","m","newNext","blockMembers","block","unblockMembers","unblock","queryBlockedMembers","blockedPids","getAllMemberInfo","_requestWithSessionToken","results","clientId","memberInfo","MEMBER","memberInfoMap","getMemberInfo","updateMemberRole","member_info_update","memberInfos","_createdAt","Conversation","ChatRoom","ServiceConversation","subscribe","unsubscribe","transformNotFoundError","CONVERSATION_NOT_FOUND","TEMPORARY_CONVERSATION_EXPIRED","TemporaryConversation","_expiredAt","ConversationQuery","_encode","source","_quote","s","replace","_calculateFlag","prev","_where","_extraOptions","_addCondition","condition","_skip","skip","_limit","_order","containsMembers","peerIds","containsAll","withMembers","includeSelf","peerIdsSet","sizeEqualTo","lessThan","lessThanOrEqualTo","greaterThan","greaterThanOrEqualTo","notEqualTo","exists","doesNotExist","containedIn","values","notContainsIn","contains","subString","startsWith","prefix","endsWith","suffix","matches","regex","_modifiers","ignoreCase","multiline","ascending","addAscending","descending","addDescending","withLastMessagesRefreshed","_executeQuery","SessionManager","refresh","onBeforeGetSessionToken","_onBeforeGetSessionToken","setSessionToken","token","sessionToken","_sessionToken","_pendingSessionTokenPromise","setSessionTokenAsync","currentSessionToken","getSessionToken","autoRefresh","newValue","revoke","isTemporaryConversatrionId","configBitmap","props","_messageParser","_conversationCache","_ackMessageBuffer","lastPatchTime","lastNotificationTime","_eventemitter","onIMClientCreate","serverTs","conv","direct","session","unread","rcp","_dispatchConvMessage","_dispatchDirectMessage","_dispatchSessionMessage","_dispatchUnreadMessage","_dispatchRcpMessage","_dispatchPatchMessage","sessionMessage","closed","SESSION_CONFLICT","unreadMessage","convs","notifTime","lastUnreadNotifTime","getConversations","mid","ts","messageProps","countNotUpdated","conversations","rcpMessage","patches","patchMessage","patchTime","initBy","getConversation","joined","left","members_joined","members_left","members_blocked","members_unblocked","blocked","unblocked","members_shutuped","members_unshutuped","shutuped","unshutuped","member_info_changed","updated","originalMessage","directMessage","fromPeerId","_sendAck","_dispatchParsedMessage","beforeMessageDispatch","push","_doSendAck","_connection","convAckMessages","timestamps","max","_omitPeerId","peerIdOmittable","peerId","tag","deviceId","isReconnect","_identity","_sessionManager","SESSION_TOKEN_EXPIRED","st","tokenTTL","stTtl","_createSessionManager","_syncNotifications","_fetchNotifications","hasMore","notifications","notification","manager","expiredSessionToken","onlineSessionPeerIds","noCache","cachedConversation","_getTemporaryConversations","ids","remoteConversationIds","remoteTemporaryConversationIds","remoteTemporaryConversationsPromise","_handleQueryResults","getChatRoomQuery","getServiceConversationQuery","where","queryJSON","commandString","_parseConversationFromRawData","_upsertConversationToCache","fetchedConversation","decodeBase64","parseConversation","conversationData","rawData","msg_from","msg_mid","msg_timestamp","patch_timestamp","lastMessageFrom","lastMessageId","lastMessageTimestamp","lastMessagePatchTimestamp","createConversation","unique","tempConv","_tempConv","tempConvTTL","_tempConvTTL","startCommandJson","cdate","createChatRoom","createTemporaryConversation","buffer","clear","_sendReadCommand","RECONNECT_ERROR","BinaryMessage","encodeBase64","TextMessage","tryParseJson","fn","wrapper","applyPlugins","beforeMessageParse","decoratedJson","afterMessageParse","MessageParser","_messageClasses","register","messageClass","unshift","Klass","contentCopy","valid","MessagePriority","defineConversationProperty","_IMClients","_IMClientsCreationCount","messageParser","realtime","signAVUser","user","messageClasses","createIMClient","identity","clientOptions","lagecyTag","buildinOptions","_tag","_firstIMClient","finally","isIMCommand","service","targetClient","IMPlugin","CoreEvent","IMEvent"],"mappings":"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"}